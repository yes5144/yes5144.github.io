(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{425:function(s,a,t){"use strict";t.r(a);var n=t(42),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("高可用性（避免单点故障）\n负载均衡（充分利用服务器性能）\n弹性伸缩（易于扩容和缩容）")])]),s._v(" "),t("blockquote",[t("p",[s._v("确立自己原则的“五步原则”")]),s._v(" "),t("p",[s._v("1、目标：我要什么？\n2、计划：我该怎么做？\n3、行动：我碰到了什么问题？\n4、反思：什么原因？\n5、改进：形成原则")])]),s._v(" "),t("h1",{attrs:{id:"一、linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、linux"}},[s._v("#")]),s._v(" 一、Linux")]),s._v(" "),t("h2",{attrs:{id:"_1-1-hello-world"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-hello-world"}},[s._v("#")]),s._v(" 1.1 Hello World")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello world'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello shell'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"_1-2-常用命令组合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-常用命令组合"}},[s._v("#")]),s._v(" 1.2 常用命令组合")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" -name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.log'")]),s._v(" -mtime +7 -type f \n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" -maxdepth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.old'")]),s._v(" -type d \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" -maxdepth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.old'")]),s._v(" -type d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Now_Time")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date +%Y%m%d%H%M%S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NowStamp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date +%s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  -i.bak  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/swap/s/^\\(.*\\)$/#"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\1"}},[s._v("\\1")]),s._v("/g'")]),s._v(" /etc/fstab\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## (1.0.21.62.)(20200916114736) 分组替换")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/\\(\\([0-9]\\{1,\\}\\.\\)\\{3,\\}\\)\\([0-9]\\{1,\\}\\)/'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\1"}},[s._v("\\1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Now_Time}")]),s._v('/g"')]),s._v(" /opt/www/index*.html\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("':a;N;"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$!")]),s._v("ba;s/nz_shouq_accountdb/nz_shouq_main/2'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 末尾2表示只替换第二个")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" redis"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("}'")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 打印第10列等于403的行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$10")]),s._v("==403 {print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v("   /opt/log/nginx/www.xxx.com.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("]++}END{for(v in a)print v,a[v]}'")]),s._v(" access.log\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://www.cnblogs.com/linuxprobe/p/11387906.html")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## grep -r 递归； -I 排除二进制文件； -n 行号； -H 文件名； --exclude 排除匹配文件； --exclude-dir 排除匹配目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -rInH --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("*.log --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("py3*  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\/opt\\/'")]),s._v(" *\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'skill  Id : 999'")]),s._v(" error.log* -C10 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v("\n\n\ntcpdump -i eth0 -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -l -w - -w aa.pcap\n\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^tcp/ {++S["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("]} END {for(a in S) print a, S[a]}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -anpo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -anpo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ESTABLISHED"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$3")]),s._v("!=0}{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -anpo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ESTABLISHED"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$3")]),s._v("!=0{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /proc/"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("pidof mysqld"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("/limits\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" -s * "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -nr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示前10个占用空间最大的文件或目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" --max-depth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# linux查找占空间最大的文件与目录  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" ./ -size -2048c -type f   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找小于2K的文件，- 表示小于")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ")]),s._v("\n\npidstat -u -p  pidnum "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 某pid 3秒内CPU使用情况")]),s._v("\n\n-u -r 内存  -d 磁盘\n\niostat  -d  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ip 按照数字排序")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),s._v(" -k1,1n  -k2,2n  -k3,3n  -k4,4n  ip.txt\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),s._v(" -k1,1rn -k2,2rn -k3,3rn -k4,4rn ip.txt\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("h2",{attrs:{id:"_1-3-系统安全和优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-系统安全和优化"}},[s._v("#")]),s._v(" 1.3 系统安全和优化")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1 close selinux")]),s._v("\nsetenforce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i /SELINUX/s/enforcing/disabled/g /etc/selinux/config\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2 close iptables firewalld")]),s._v("\nsystemctl stop iptables.service  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl disable  iptables.service\nsystemctl stop firewalld.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl disable firewalld.service\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3 中文支持")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("  /etc/sysconfig/i18n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LANG=\"zh_CN.UTF-8\"'")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/sysconfig/i18n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LC_ALL=\"zh_CN.UTF-8\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/sysconfig/i18n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("  /etc/sysconfig/i18n\n\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#######")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("   /etc/locale.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LANG=\"zh_CN.UTF-8\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/locale.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/locale.conf\n\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### 设置timezone的时区")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##sudo timedatectl set-timezone 'Asia/Shanghai'")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 或者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Asia/Shanghai"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/timezone\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 4 设置时间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /etc/localtime\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 5 sync time")]),s._v("\nntpdate times.aliyun.com\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'# time sync to aliyun 2017-08-21'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /var/spool/cron/root\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*/5 * * * * /usr/sbin/ntpdate times.aliyun.com >/dev/null 2>&1'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/var/spool/cron/root\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 6 base.repo epel.repo docker.repo")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y sysstat tree net-tools "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" lrzsz "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("zip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" python-pip python-devel python36 python36-devel python36-pip bash-completion\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v("  /etc/yum.repos.d/default\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repos.d/*.repo /etc/yum.repos.d/default/\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\n\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 7 添加 www mysql (no home)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" myadmin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yourpasswd123#@!'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" myadmin --stdin\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" www -M -s /sbin/nologin \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" mysql -M -s /sbin/nologin\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 8 sshd 配置优化")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("cp /etc/ssh/sshd_config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(",.bak"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#UseDNS yes@UseDNS no@g;s@^GSSAPIAuthentication yes@GSSAPIAuthentication no@g'")]),s._v(" /etc/ssh/sshd_config\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 禁用root远程，添加myadmin sudoers")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sed -i 's@#PermitRootLogin yes@PermitRootLogin no@g' /etc/ssh/sshd_config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sed -i 's@#Port 22@Port 52222@g' /etc/ssh/sshd_config")]),s._v("\n/etc/init.d/sshd reload\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 9 系统参数优化")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1. 计算 fdmax = 物理内存大小(m为单位) / 4 * 256  假设内存为8G,fdmax=524288")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2. 执行命令: echo fs.file-max=524288 >> /etc/sysctl.conf")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3. 执行命令: sysctl -p ")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4. 执行命令: echo  * soft nofile  524286 >> /etc/security/limits.conf")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5. 执行命令: echo  * hard nofile 524287 >> /etc/security/limits.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" fs.file-max"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/sysctl.conf\nsysctl -p \n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'* soft nofile  524286'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/security/limits.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'* hard nofile  524287'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/security/limits.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/supervisord.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# minfds=1048576")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/sysctl.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n# https://www.cnblogs.com/kgdxpr/p/3342102.html\n\n# source configuration\n# /sbin/sysctl -p\n#######禁用ipv6#######\n# 禁用整个系统所有接口的IPv6\nnet.ipv6.conf.all.disable_ipv6 = 1\n# 禁用某一个指定接口的IPv6(例如：eth0, lo)\nnet.ipv6.conf.lo.disable_ipv6 = 1\nnet.ipv6.conf.eth0.disable_ipv6 = 1\n\n#######################\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_tw_recycle = 1\nnet.ipv4.ip_local_port_range = 1024 65000\nnet.ipv4.tcp_max_syn_backlog = 8192\nnet.ipv4.tcp_max_tw_buckets = 5000\nnet.ipv4.tcp_max_syn_backlog = 65536\nnet.core.netdev_max_backlog =  32768\nnet.core.somaxconn = 32768\nnet.core.wmem_default = 8388608\nnet.core.rmem_default = 8388608\nnet.core.rmem_max = 16777216\nnet.core.wmem_max = 16777216\nnet.ipv4.tcp_timestamps = 0\nnet.ipv4.tcp_synack_retries = 2\nnet.ipv4.tcp_syn_retries = 2\nnet.ipv4.tcp_mem = 94500000 915000000 927000000\nnet.ipv4.tcp_max_orphans = 3276800\n\nkernel.sysrq = 0\nkernel.core_uses_pid = 1\nkernel.msgmnb = 65536\nkernel.msgmax = 65536\nkernel.shmmax = 68719476736\nkernel.shmall = 4294967296\nvm.swappiness=10\nEOF")]),s._v("\n\nsysctl -p \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 10 安全问题  把暴力登录的ip 追加到/etc/hosts.deny")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/bin/ssh_scan.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n#! /bin/bash\ncat /var/log/secure|awk '/Failed/{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("NF-3"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("}'|sort|uniq -c|awk '{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v('"="'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(';}\' > /tmp/black.txt\nDEFINE="10"\nfor i in '),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("  /tmp/black.txt"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\ndo\n    IP="),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    NUM="),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    if [ "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NUM")]),s._v(" -gt "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DEFINE")]),s._v(" ];then\n         grep "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$IP")]),s._v(" /etc/hosts.deny > /dev/null\n         if [ "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(' -gt 0 ];then\n            echo "sshd:'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$IP")]),s._v('" >> /etc/hosts.deny\n         fi\n    fi\ndone\nEOF')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 加入定时任务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'####SSH_Failed_Access_Scan####'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/crontab\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*/1 * * * * root sh /bin/ssh_scan.sh'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/crontab\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 11 重要文件加锁，禁止修改如 /etc/passwd /etc/shadow /etc/sudoers /root/.ssh/authorized_keys")]),s._v("\nchattr +i  /etc/passwd /etc/group /etc/shadow /etc/sudoers /root/.ssh/authorized_keys\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsattr ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chattr -i file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chattr -R +i dir")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 12 预留端口需要吗？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"39003-39004"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /proc/sys/net/ipv4/ip_local_reserved_ports\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br")])]),t("h3",{attrs:{id:"_1-3-1-防火墙iptables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-防火墙iptables"}},[s._v("#")]),s._v(" 1.3.1 防火墙iptables")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/bin/iptables.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n#!/bin/bash\niptables -F\niptables -t nat -F\n\n#### Below are the basal iptables config, normally need not be modified #######\niptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\niptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT\niptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT\niptables -A INPUT -p udp --source-port 53 -j ACCEPT\niptables -A INPUT -p tcp --dport 62222 -j ACCEPT\niptables -A INPUT -p tcp --dport 22 -j ACCEPT\n\n##### Below are the Appalication related iptables config #######\niptables -A INPUT -s 10.0.5.0/24 -j ACCEPT\n\niptables -A INPUT -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -p tcp --dport 443 -j ACCEPT\n\niptables -A INPUT -j DROP\niptables -A FORWARD -j DROP\nEOF")]),s._v("\n\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" iptables.service\nsystemctl restart iptables.service\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("  /bin/iptables.sh\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sh /bin/iptables.sh'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/rc.local\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## iptables防火墙")]),s._v("\n\niptables最常用的规则示例\nhttps://www.cnblogs.com/EasonJim/p/8339162.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 1、删除已有规则")]),s._v("\niptables -F\niptables –flush\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 2、设置链的默认策略")]),s._v("\niptables -P INPUT DROP\niptables -P FORWARD DROP\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##### iptables -P OUTPUT DROP ## 一般不对出站的数据包做限制")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 3、丢弃来自IP地址x.x.x.x的包")]),s._v("\niptables -A INPUT -s x.x.x.x -j DROP\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### 3.1、阻止来自IP地址x.x.x.x eth0 tcp的包")]),s._v("\niptables -A INPUT -i eth0 -s x.x.x.x -j DROP\niptables -A INPUT -i eth0 -p tcp -s x.x.x.x -j DROP\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 4、允许所有来自外部的SSH连接请求，即只允许进入eth0接口，并且目标端口为22的数据包")]),s._v("\niptables -A INPUT -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 5、仅允许来自于192.168.100.0/24域的用户的ssh连接请求")]),s._v("\niptables -A INPUT -i eth0 -p tcp -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.0/24 --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 6、允许所有来自web - http的连接请求")]),s._v("\niptables -A INPUT -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\niptables -A INPUT -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 7、使用multiport 将多个规则结合在一起（允许所有ssh,http,https的流量访问）")]),s._v("\niptables -A INPUT -i eth0 -p tcp -m multiport --dports "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22,80")]),s._v(",443 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp -m multiport --sports "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22,80")]),s._v(",443 -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 8、负载平衡传入的网络流量")]),s._v("\niptables -A PREROUTING -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -m state --state NEW -m nth --counter "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" --packet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -j DNAT --to-destination "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101:443\niptables -A PREROUTING -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -m state --state NEW -m nth --counter "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" --packet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -j DNAT --to-destination "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102:443\niptables -A PREROUTING -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -m state --state NEW -m nth --counter "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" --packet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" -j DNAT --to-destination "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.103:443\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 9、允许外部主机ping内部主机")]),s._v("\niptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT\niptables -A OUTPUT -p icmp --icmp-type echo-reply -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 10、允许来自网络192.168.101.0/24的rsync连接请求")]),s._v("\niptables -A INPUT -i eth0 -p tcp -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".101.0/24 --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("873")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("873")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 11、MySQL数据库与web服务跑在同一台服务器上。有时候我们仅希望DBA和开发人员从内部网络（192.168.100.0/24）直接登录数据库，可尝试以下命令：")]),s._v("\niptables -A INPUT -i eth0 -p tcp -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.0/24 --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 12、将来自422端口的流量全部转到22端口。  这意味着我们既能通过422端口又能通过22端口进行ssh连接。启用DNAT转发。")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##### 系统开启转发功能")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /proc/sys/net/ipv4/ip_forward\niptables -t nat -A PREROUTING -p tcp -d "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".102.37 --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("422")]),s._v(" -j DNAT --to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".102.37:22\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#####除此之外，还需要允许连接到422端口的请求 ")]),s._v("\niptables -A INPUT -i eth0 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("422")]),s._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -o eth0 -p tcp --sport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("422")]),s._v(" -m state --state ESTABLISHED -j ACCEPT\n\n\n\niptables 四表五链\nhttps://www.cnblogs.com/zhujingzhi/p/9706664.html\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br")])]),t("h3",{attrs:{id:"_1-3-2-防火墙firewired"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-防火墙firewired"}},[s._v("#")]),s._v(" 1.3.2 防火墙firewired")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("firewall-cmd --list-all\nfirewall-cmd --add-ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("/tcp --permernent\nfirewall-cmd --reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"_1-3-3-cc-和ddos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-cc-和ddos"}},[s._v("#")]),s._v(" 1.3.3 cc 和ddos")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# date: 2018-04-12")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# author: channel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -z "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd where is the shell")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$(")]),s._v("dirname "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$BASH_SOURCE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("check")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("iplist")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -an "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ^tcp.*.80"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("egrep")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LISTEN|127.0.0.1'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[ ]+|[:]"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$4")]),s._v("}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -z "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$iplist")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ./iplist/black_ip.txt\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("black_ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$iplist")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# exclude_ip=`echo $black_ip |awk -F "." \'{print "$1"."$2"."$3"}\'`')]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep -q $excude_ip ./white_ip.txt")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -q "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(" ./white_ip.txt\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(' (white_ip)"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("./black_ip.txt\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./black_ip.txt\n\t\t\t\tiptables -nL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("iptables -I INPUT -s £"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(" -j DROP "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$black_ip")]),s._v(' exist"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ./sendmail"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" sendmsg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("sendmsg")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -nutlp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sendmail"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" /etc/init.d/sendmail start "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"From: 1006793841@qq.com'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("To:22222222222@qq.com"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Subject:Someone Attacking you system"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ./black_ip.txt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("./message\n\t/usr/sbin/sendmail -f sendaddr@qq.com -t recieve_add@qq.com -i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("./message\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("./sendmail\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\tcheck\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# date: 2018-4-11")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# author: channel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FilePath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"access.log"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FilePath")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -rn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("ip_count.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ip_count.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" text\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ip")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$test")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$count")]),s._v(" -gt "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" iptables -L "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip address exists iptables, no add again"')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip")]),s._v(' address in iptables"')]),s._v("\n\t\t\tiptables -A INPUT -s "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip")]),s._v(" -j DROP "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ip_drop.log\n\t\t\t/etc/init.d/iptables save "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&>")]),s._v(" /dev/null\n\t\t\t/etc/init.d/iptables restart "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&>")]),s._v("/dev/null\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no ip will be add iptables"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# remember to create a crontab task for this shell")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("h1",{attrs:{id:"二、nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、nginx"}},[s._v("#")]),s._v(" 二、Nginx")]),s._v(" "),t("h2",{attrs:{id:"_2-22-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-22-配置"}},[s._v("#")]),s._v(" 2.22 配置")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####### 负载均衡配置：")]),s._v("\nupstream myapp {\n    server 192.168.0.111:8080; # 应用服务器1\n    server 192.168.0.112:8080; # 应用服务器2\n}\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://myweb;\n    }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###### 反向代理")]),s._v("\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://192.168.0.112:8080; # 应用服务器HTTP地址\n    }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###### 虚拟主机")]),s._v("\nserver {\n    listen 80 default_server;\n    server_name _;\n    return 444; # 过滤其他域名的请求，返回444状态码\n}\nserver {\n    listen 80;\n    server_name www.aaa.com; # www.aaa.com域名\n    location / {\n        proxy_pass http://localhost:8080; # 对应端口号8080\n    }\n}\nserver {\n    listen 80;\n    server_name www.bbb.com; # www.bbb.com域名\n    location / {\n        proxy_pass http://localhost:8081; # 对应端口号8081\n    }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##### 另外，server_name配置还可以过滤有人恶意将某些域名指向你的主机服务器。")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### FastCGI")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### Nginx本身不支持PHP等语言，但是它可以通过FastCGI来将请求扔给某些语言或框架处理（例如PHP、Python、Perl）。")]),s._v("\nserver {\n    listen 80;\n    location ~ \\.php$ {\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME /PHP文件路径$fastcgi_script_name; # PHP文件路径\n        fastcgi_pass 127.0.0.1:9000; # PHP-FPM地址和端口号\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("        # 另一种方式：fastcgi_pass unix:/var/run/php5-fpm.sock;")]),s._v("\n    }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## rewirte")]),s._v("\nserver {\n        listen 80;\n        server_name monitor.xxxx.com;\n        rewrite ^(.*)$ https://${server_name}$1 permanent;\n}\n\nserver {\n        server_name monitor.xxxx.com ;\n        listen 443 ssl;\n        ssl_certificate  /usr/local/nginx/conf/888__xxxx.com.pem;\n        ssl_certificate_key  /usr/local/nginx/conf/888__xxxx.com.key;\n        index  index.html index.htm;\n        root  /opt/www/xxxx_web/dist;\n\n        location ~ .*\\.(jpg|png|jpeg)$ {\n            expires      30d;\n        }\n\n        location / {\n            try_files $uri $uri/ /index.html;\n            expires      7d;\n        }\n\n        access_log  /opt/log/nginx/monitor.xxxx.com.log;\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 防盗链 在nginx的conf中配置")]),s._v("\nlocation ~.*\\.(gif|jpg|png|flv|swf|rar|zip)$\n{\n    valid_referers none blocked zi.com *.zi.com;\n    if($invalid_referer)\n    {\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("        #return 403;")]),s._v("\n        rewrite ^/ http://www.zi.com/403.jpg;\n    }    \n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br")])]),t("h2",{attrs:{id:"_2-3-vhost"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-vhost"}},[s._v("#")]),s._v(" 2.3 vhost")]),s._v(" "),t("h2",{attrs:{id:"_2-4-动态负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-动态负载均衡"}},[s._v("#")]),s._v(" 2.4 动态负载均衡")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_2-5-http-登录验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-http-登录验证"}},[s._v("#")]),s._v(" 2.5 http 登录验证")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://www.cnblogs.com/clsn/p/9950892.html")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v("# yum install httpd-tools -y\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v("# htpasswd  -c /usr/local/awstats/wwwroot/nmtui.passwd nmtui\nNew password:\nRe-type new password:\nAdding password for user nmtui\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v("# chown www.www  /usr/local/awstats/wwwroot/nmtui.passwd\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v("# chmod 600  /usr/local/awstats/wwwroot/nmtui.passwd\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v('# vim  awstats.nmtui.com.conf\nserver\n{\n    listen 80;\n    server_name awstats.nmtui.com;\n    index awstats.nmtui.com.html;\n    root /www/wwwroot/awstats/;\n    auth_basic "clsn training";\n    auth_basic_user_file /usr/local/awstats/wwwroot/nmtui.passwd;\n    access_log  /www/wwwlogs/301-clsn.io.log;\n    error_log  /www/wwwlogs/301-clsn.io-error.log;\n}\n'),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@clsn nginx]")]),s._v("# /etc/init.d/nginx  reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h2",{attrs:{id:"_2-9-nginx-调优"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-nginx-调优"}},[s._v("#")]),s._v(" 2.9 nginx 调优")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("Nginx调优\nhttps://www.cnblogs.com/zhichaoma/p/7989655.html\n    1.隐藏 Nginx 版本号\n    2.隐藏 Nginx 版本号和软件名\n    3.更改 Nginx 服务的默认用户\n    4.优化 Nginx worker 进程数\n    5.绑定 Nginx 进程到不同的 CPU 上\n    6.优化 Nginx 处理事件模型\n    7.优化 Nginx 单个进程允许的最大连接数\n    8.优化 Nginx worker 进程最大打开文件数\n    9.优化服务器域名的散列表大小\n    10.开启高效文件传输模式\n    11.优化 Nginx 连接超时时间\n    12.限制上传文件的大小\n    13.FastCGI 相关参数调优\n    14.配置 Nginx gzip 压缩\n    15.配置 Nginx expires 缓存\n    16.优化 Nginx日志(日志切割)\n    17.优化 Nginx 站点目录\n    18.配置 Nginx 防盗链\n    19.配置 Nginx 错误页面优雅显示\n    20.优化 Nginx 文件权限\n    21.Nginx 防爬虫优化\n    22.控制 Nginx 并发连接数\n    23.集群代理优化\n\nNginx 性能调优\nhttps://www.jianshu.com/p/024b33d1a1a1\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("h1",{attrs:{id:"三、mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、mysql"}},[s._v("#")]),s._v(" 三、MySQL")]),s._v(" "),t("h2",{attrs:{id:"_3-1-基础操作命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-基础操作命令"}},[s._v("#")]),s._v(" 3.1 基础操作命令")]),s._v(" "),t("h3",{attrs:{id:"_3-1-1-添加索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-添加索引"}},[s._v("#")]),s._v(" 3.1.1 添加索引")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1.添加PRIMARY KEY（主键索引） ")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2.添加UNIQUE(唯一索引) ")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3.添加INDEX(普通索引) ")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" index_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 4.添加FULLTEXT(全文索引) ")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" FULLTEXT "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 5.添加多列索引 ")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" index_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("column1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("column2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("column3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_3-1-2-复制表到新表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-复制表到新表"}},[s._v("#")]),s._v(" 3.1.2 复制表到新表")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("方法一：\n拷贝表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("的全部数据到表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" table2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table1 \n\n拷贝第n条\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" table2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table1  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n拷贝指定字段\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" table2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" price "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" price  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table1  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n方法二：\n创建表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("， 同时拷贝表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("的数据和结构到表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" table3 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v("\n\n方法三：\n创建表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("，只拷贝表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("的结构到表"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("，不拷贝数据\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" table4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("LIKE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v("\n\n版权声明：本文为CSDN博主「一筐大白菜啊」的原创文章，遵循 CC "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("SA 版权协议，转载请附上原文出处链接及本声明。\n原文链接：https:"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//blog.csdn.net/sphinx1122/article/details/84402854")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h3",{attrs:{id:"_3-1-3-部分配置文件参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-部分配置文件参考"}},[s._v("#")]),s._v(" 3.1.3 部分配置文件参考")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[client]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("default-character-set")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("utf8")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[mysql]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("default-character-set")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("utf8")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[mysqld]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("init_connect")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("'SET collation_connection = utf8_unicode_ci'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("init_connect")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("'SET NAMES utf8'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("character-set-server")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("utf8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("collation-server")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("utf8_unicode_ci")]),s._v("\nskip-character-set-client-handshake\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-grant-tables")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### MySQL5.6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#UPDATE mysql.user SET Password = password('123456') WHERE User = 'root' ; ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### MySQL5.7")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#update mysql.user set authentication_string=password('123qwe') where user='root' and Host = 'localhost';")]),s._v("\n\n————————————————\n版权声明：本文为CSDN博主「o尐猫o」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/dy_miao/article/details/91461581\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h2",{attrs:{id:"_3-2-备份和还原"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-备份和还原"}},[s._v("#")]),s._v(" 3.2 备份和还原")]),s._v(" "),t("h3",{attrs:{id:"_3-2-1-mysqldump-备份"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-mysqldump-备份"}},[s._v("#")]),s._v(" 3.2.1 mysqldump 备份")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("https://www.cnblogs.com/chenmh/p/5300370.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1.该命令会导出包括系统数据库在内的所有数据库")]),s._v("\nmysqldump -uroot -proot --all-databases "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/all.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2.导出db1、db2两个数据库的所有数据")]),s._v("\nmysqldump -uroot -proot --databases db1 db2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/user.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3.导出db1中的a1、a2表")]),s._v("\nmysqldump -uroot -proot --databases db1 --tables a1 a2  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/db1.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 4.条件导出，导出db1表a1中id=1的数据")]),s._v("\nmysqldump -uroot -proot --databases db1 --tables a1    --where"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'id=1'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/a1.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 5.字段是字符串,并且导出的sql中不包含drop table,create table")]),s._v("\nmysqldump -uroot -proot --no-create-info --databases db1 --tables a1 --where"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"id='a'\"")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/a1.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 6.只导出表结构不导出数据，--no-data")]),s._v("\nmysqldump -uroot -proot --no-data --databases db1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/db1.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/application/mysql/bin:'),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBPATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/server/backup\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MY_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MY_PASS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("old123\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SOCKET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/3306/mysql.sock\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MY_CMD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql -u'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MY_USER")]),s._v(" -p"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MY_PASS")]),s._v(" -S "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SOCKET")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MY_DUMP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysqldump -u'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MY_USER")]),s._v(" -p"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MY_PASS")]),s._v(" -S"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SOCKET")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DBPATH")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DBPATH")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("dbname")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("$MYCMD -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"show databases;"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1,2d'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("egrep")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql|schema"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYDUMP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$dbname")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DBPATH")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${dbname}")]),s._v("_"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%F"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(".sql.gz\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br")])]),t("h3",{attrs:{id:"_3-2-2-mysql-还原"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-mysql-还原"}},[s._v("#")]),s._v(" 3.2.2 mysql 还原")]),s._v(" "),t("h3",{attrs:{id:"_3-2-3-mysqlbinlog-解析binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-mysqlbinlog-解析binlog"}},[s._v("#")]),s._v(" 3.2.3 mysqlbinlog 解析binlog")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://www.cnblogs.com/michael9/p/11923483.html")]),s._v("\n\nmysqlbinlog -v -v --base64-output"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DECODE-ROWS --set-charset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UTF-8  --start-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("309610")]),s._v(" --stop-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("328251")]),s._v(" mysql-bin.000002 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" recover.sql\nmysqlbinlog -v -v --base64-output"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DECODE-ROWS --set-charset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UTF-8  mysql-bin.000001  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_3-2-4-binlog2sql-回滚sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-binlog2sql-回滚sql"}},[s._v("#")]),s._v(" 3.2.4 binlog2sql 回滚SQL")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("https://github.com/danfengcao/binlog2sql\n\n[mysqld]\nserver_id = 1\nlog_bin = /var/log/mysql/mysql-bin.log\nmax_binlog_size = 1G\nbinlog_format = row\nbinlog_row_image = full\n\n######\n## 解析标准SQL\npython binlog2sql.py -h127.0.0.1 -P3306 -uadmin -p'admin' -dtest -t test3 test4 --start-file='mysql-bin.000002'\n\n## 解析回滚SQL -B, --flashback\npython binlog2sql.py -h127.0.0.1 -P3306 -uadmin -p'admin' -dtest -ttest3 --start-file='mysql-bin.000002' --start-position=763 --stop-position=1147 -B\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h3",{attrs:{id:"_3-2-5-xtrabackup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-xtrabackup"}},[s._v("#")]),s._v(" 3.2.5 xtrabackup")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# this is a example about xtrabackup")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# coding:utf8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全量备份 -> 增量1 -> 增量2 -> ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全量备份00，假设全量文件是/backup_file/00")]),s._v("\ninnobackupex --user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root --password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123123'")]),s._v(" /backup_file/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增量1, 文件是/backup_file/11")]),s._v("\ninnobackupex --incremental /backup_file --incremental-basedir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup_file/00\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增量2, 文件是/backup_file/22")]),s._v("\ninnobackupex --incremental /backup_file --incremental-basedir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup_file/11\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 整合# ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 准备全量00")]),s._v("\ninnobackupex --apply-log --redo-only /backup_file/00\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 准备11")]),s._v("\ninnobackupex --apply-log --redo-only /backup_file/00/ --incremental-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup_file/11\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 准备22")]),s._v("\ninnobackupex --apply-log --redo-only /backup_file/00/ --incremental-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup_file/22\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#################")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复数据")]),s._v("\ninnobackupex --copy-back /backup_file/00\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改属主、属组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql.mysql /usr/local/mysql/data\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动mysql")]),s._v("\n/etc/init.d/mysqld start\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### 5，恢复binlog中的部分文件")]),s._v("\n\nmysqlbinlog mysql-bin.000002 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tmp/abc.sql\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂时关闭binlog记录")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql_log_bin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /tmp/abc.sql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复完成，打开binlog记录")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql_log_bin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br")])]),t("h2",{attrs:{id:"_3-3-主从复制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-主从复制"}},[s._v("#")]),s._v(" 3.3 主从复制")]),s._v(" "),t("h3",{attrs:{id:"_3-3-0-主从复制方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-0-主从复制方式"}},[s._v("#")]),s._v(" 3.3.0 主从复制方式")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_3-3-1-传统binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-传统binlog"}},[s._v("#")]),s._v(" 3.3.1 传统binlog")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3-3-2-基于gtid（建议使用mysql-5-6-5以上版本）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-基于gtid（建议使用mysql-5-6-5以上版本）"}},[s._v("#")]),s._v(" 3.3.2 基于GTID（建议使用mysql-5.6.5以上版本）")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("MySQL GTID 主从复制的原理及配置 https://blog.51cto.com/yangshufan/2136862\n\n四、GTID的工作原理\n1、当一个事务在主库端执行并提交时，产生GTID，一同记录到binlog日志中。\n\n2、binlog传输到slave,并存储到slave的relaylog后，读取这个GTID的这个值设置gtid_next变量，即告诉Slave，下一个要执行的GTID值。\n\n3、sql线程从relay log中获取GTID，然后对比slave端的binlog是否有该GTID。\n\n4、如果有记录，说明该GTID的事务已经执行，slave会忽略。\n\n5、如果没有记录，slave就会执行该GTID事务，并记录该GTID到自身的binlog，   在读取执行事务前会先检查其他session持有该GTID，确保不被重复执行。\n\n6、在解析过程中会判断是否有主键，如果没有就用二级索引，如果没有就用全部扫描。\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_3-9-mysql参数调优"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-mysql参数调优"}},[s._v("#")]),s._v(" 3.9 MySQL参数调优")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/zhichaoma/p/7992525.html\n\n 连接相关参数\n\n 文件相关参数\n\n 缓存相关参数 \n\n MyISAM参数\n\n InnoDB参数\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h1",{attrs:{id:"四、django"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、django"}},[s._v("#")]),s._v(" 四、Django")]),s._v(" "),t("h2",{attrs:{id:"_4-0-py虚拟环境（virtualenv的使用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-0-py虚拟环境（virtualenv的使用）"}},[s._v("#")]),s._v(" 4.0 py虚拟环境（virtualenv的使用）")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## centos7安装")]),s._v("\nyum  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" –y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" gcc-c++ python36-devel python36-pip libxml2-devel libxslt-devel\n\npip3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" virtualenv virtualenvwrapper\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WORKON_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.virtualenvs\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PROJECT_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/workspace\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /usr/local/bin/virtualenvwrapper.sh\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用方法：")]),s._v("\nmkvirtualenv zqxt "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建运行环境zqxt")]),s._v("\n\nworkon zqxt   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#工作在 zqxt 环境")]),s._v("\n\nmkproject -p /usr/bin/python3 py3-pyspider  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建mic项目和运行环境mic")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 拓展：")]),s._v("\nrmvirtualenv ENV "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除运行环境ENV")]),s._v("\nmkproject mic  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建mic项目和运行环境mic")]),s._v("\nmkproject -p /usr/bin/python3 py3-pyspider  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建mic项目和运行环境mic")]),s._v("\n\nmktmpenv   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建临时运行环境")]),s._v("\nlsvirtualenv  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#列出可用的运行环境")]),s._v("\nlssitepackages  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#列出当前环境安装了的包")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 创建的环境是独立的，互不干扰，无需sudo权限即可使用 pip 来进行包的管理。")]),s._v("\npip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --ignore-installed pycurl\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h2",{attrs:{id:"_4-1-django路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-django路由"}},[s._v("#")]),s._v(" 4.1 Django路由")]),s._v(" "),t("p",[s._v("4.1.1 Django哈哈")]),s._v(" "),t("div",{staticClass:"language-pyhon line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("python manage.py startapp test\npython manage.py makemigrations\npython manage.py migrate\npython manage createsuperuser\n\n2.0后urls文件内的path好像不支持正则了 \n\n需要用正则匹配的 需要\n\nfrom django.urls import re_path\n\nurlpatterns = [\n    re_path('index-(?P<nid>\\d)-(?P<uid>\\d)', views.index)\n}\n————————————————\n版权声明：本文为CSDN博主「Reisen稻叶」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/u011410397/java/article/details/81780495\n\nbe determined to have a great day, and you will\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h1",{attrs:{id:"五、saltstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、saltstack"}},[s._v("#")]),s._v(" 五、saltstack")]),s._v(" "),t("h2",{attrs:{id:"_5-1-使用入门"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-使用入门"}},[s._v("#")]),s._v(" 5.1 使用入门")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/salt/master "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^$'")]),s._v("\n\n/etc/init.d/salt-master restart\n\nsalt -L "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HD-HZ-H5PLAT-WEB05'")]),s._v(" state.sls sysinit\n\nsalt -v "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HD-HZ-H5PLAT-WEB05'")]),s._v(" state.highstate -l debug -t "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v("\n\nsalt-run jobs.lookup_jid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20190426130418644064")]),s._v("\n\nhttps://docs.saltstack.com/en/latest/ref/runners/all/salt.runners.jobs.html\nhttp://dearweb.xin/2017/10/24/salt-file-backup/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#################################")]),s._v("\nsalt -d  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看帮助文档")]),s._v("\nsalt -d"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看service相关模块命令")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" sys.doc  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看帮助文档")]),s._v("\nsalt-key  -L            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询所有接收到的证书")]),s._v("\nsalt-key  -a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("证书名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#接收单个证书")]),s._v("\nsalt-key  -A            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#接受所有证书")]),s._v("\nsalt-key  -d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("证书名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除单个证书")]),s._v("\nsalt-key  -D            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除所有证书")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## service")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" service.get_all  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##获取主机所有服务")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" service.reload sshd  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##重载sshd服务")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node1.com'")]),s._v(" service.status mysql  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看mysql服务状态")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node1.com'")]),s._v(" service.start mysql  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##启动mysql服务")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node1.com'")]),s._v(" cmd.run "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'service mysql status'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##与上面一样查看服务")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" sys.list_modules  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##模块列表")]),s._v("\nsalt-cp "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("  /etc/hosts   /etc/hosts  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##把master上的hosts文件分发到所有主机")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cp.get_file salt://ceshi/b /tmp/test  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##把salt-master端相应的文件，分发文件到minion端")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cp.get_dir salt://zabbix /tmp  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##把salt-master端相应的目录，分发文件到minion端")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" file.copy /tmp/zabbix.sls /tmp/sls  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##把salt-master端对应文件拷贝到minion端相应目录下")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## pkg")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" pkg.list_pkgs   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##显示软件包版本列表")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" pkg.version python  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##显示软件包版本信息")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" pkg.install httpd  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##安装软件包")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cmd.script:'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.script salt://scripts/runme.sh\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.script salt://scripts/runme.sh "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'arg1 arg2 \"arg 3\"'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.script salt://scripts/windows_task.ps1 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("args")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' -Input c:"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[s._v("\\t")]),s._v("mp\\infile.txt'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'powershell'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.script salt://scripts/runme.sh "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'one"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("two"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("three"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("four"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("five"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cmd.shell:'")]),s._v("\n        This passes the cmd argument directly to the shell\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shell "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"ls -l | awk '/foo/{print \\"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'\"")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shell "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("template")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("jinja "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls -l /tmp/'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("grains"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("."),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" | awk '/foo/{print \\"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'\"")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shell "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Get-ChildItem C:\\ "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'powershell'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shell "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"grep f"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'one"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("two"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("three"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("four"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("five"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shell "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cmd")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sed -e s/=/:/g'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cmd.shells:'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.shells\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cmd.tty:'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.tty tty0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This is a test'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.tty pts3 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This is a test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cmd.which:'")]),s._v("\n        salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.which "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## grains")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" grains.ls   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看grains分类")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" grains.items   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看grains所有信息")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" grains.item osrelease  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看grains某个信息")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## manage")]),s._v("\nsalt-run manage.up   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看存活的minion")]),s._v("\nsalt-run manage.down  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看死掉的minion")]),s._v("\nsalt-run manage.down "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("removekeys")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("True   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看down掉的minion，并将其删除")]),s._v("\nsalt-run manage.status   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看minion的相关状态")]),s._v("\nsalt-run manage.versions   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看slat的所有master和minion的版本信息")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## jobs")]),s._v("\nsalt-run jobs.active\nsalt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("* saltutil.running  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##查看运行的jobs ID")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("* saltutil.kill_job "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20151209034239907625")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##kill掉进程ID")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### saltutil模块中的job管理方法")]),s._v("\nsaltutil.running "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看minion当前正在运行的jobs")]),s._v("\nsaltutil.find_job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看指定jid的job(minion正在运行的jobs)")]),s._v("\nsaltutil.signal_job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("single"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#给指定的jid进程发送信号")]),s._v("\nsaltutil.term_job "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#终止指定的jid进程(信号为15)")]),s._v("\nsaltutil.kill_job "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#终止指定的jid进程(信号为9)")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### salt runner中的job管理方法")]),s._v("\nsalt-run jobs.active "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有minion当前正在运行的jobs(在所有minions上运?saltutil.running)")]),s._v("\nsalt-run jobs.lookup_jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#从master jobs cache中查询指定jid的运行结果")]),s._v("\nsalt-run jobs.list_jobs "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#列出当前master jobs cache中的所有job")]),s._v("\n\nsalt-run jobs.active\nsalt-run jobs.list_jobs\nsalt-run jobs.list_job "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20190823152131069508")]),s._v("\nsalt-run jobs.lookup_jid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20190823152136187925")]),s._v("\n\nhttps://docs.saltstack.com/en/latest/ref/states/backup_mode.html"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#file-state-backups")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br")])]),t("h2",{attrs:{id:"_5-2-salt-api-安装部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-salt-api-安装部署"}},[s._v("#")]),s._v(" 5.2 salt-api 安装部署")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生成证书")]),s._v("\nsalt-call --local tls.create_self_signed_cert\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -k https://172.10.15.2:55880/login -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accept: application/x-yaml"')]),s._v("  -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'saltapi222'")]),s._v("  -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'saltapi222@##"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$$")]),s._v("##'")]),s._v("  -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("eauth")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pam'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 链接：https://www.jianshu.com/p/012ccdff93cc")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -M -s /sbin/nologin saltapi222\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" saltapi222\nsaltapi222@"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##$$##")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###############")]),s._v("\nopenssl 生成加密文件\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 222")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 install")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y salt-api\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 adduser")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -M -s /sbin/nologin salt "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"salt@@123"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" --stdiin salt\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 配置证书文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/ssl/private\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生成key")]),s._v("\nopenssl genrsa -out /etc/ssl/private/key.pem "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生成证书")]),s._v("\nopenssl req -new -x509 -key /etc/ssl/private/key.pem -out /etc/ssl/private/cert.pem -days "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1826")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 为salt-api单独配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/salt/master.d/salt-api.conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\nexternal_auth:\n    pam:\n        salt:\n            - .*\n            - '@whell'\n            - '@runner'\n            - '@jobs'\n\nrest_cherrypy:\n    port: 58080\n    host: 0.0.0.0\n    ssl_crt: /etc/ssl/private/cert.pem\n    ssl_key: /etc/ssl/private/key.pem\n    # disable_ssl: True\nEOF")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启master 和salt-api")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" salt-master restart\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" salt-api restart\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" API 测试验证\n获取token\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -k https://127.0.0.1:8080/login -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accept: application/json"')]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'salt'")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'salt@@123'")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("eauth")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pam'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -k https://localhost:8080/ -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accept: application/json"')]),s._v(" -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"X-Auth-Token: ff3k3k23k2332"')]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("client")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'local'")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tgt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.204.160'")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fun")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmd.run"')]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("arg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uname -a"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\njq JSON格式化输出\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y jq \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" json_test.txt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br")])]),t("h3",{attrs:{id:"_5-2-1-salt-api-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-salt-api-使用"}},[s._v("#")]),s._v(" 5.2.1 salt-api 使用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("## https://www.jianshu.com/p/012ccdff93cc\n\nhttps://www.cnblogs.com/tutuye/p/11590599.html\n## salt-api api接口\nhttps://honglimin.cn/saltstack/08_saltapi_doc.html\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"_5-3-salt-ssh-批量部署minion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-salt-ssh-批量部署minion"}},[s._v("#")]),s._v(" 5.3 salt-ssh 批量部署minion")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" salt-ssh\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"_5-8-ansible"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-ansible"}},[s._v("#")]),s._v(" 5.8 ansible")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 常用模块")]),s._v("\n\n根据模块功能分类为：云模块、命令模块、数据库模块、文件模块、资产模块、消息模块、监控模块、网络模块、通知模块、包管理模块、源码控制模块、系统模块、单元模块、web设施模块、Windows模块。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 安装ansible")]),s._v("\n\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ansible -y\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ql ansible\n\n/etc/ansible\n/etc/ansible/ansible.cfg\n/etc/ansible/hosts\n/etc/ansible/roles\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\nansible -h\n\nansible --version\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/etc/ansible/hosts "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n\n[test]\n192.168.0.211\n\n# children\n[mfs:children]\nmfs_master\nmfs_client\nmfs_node\n\n[mfs_master]\n192.168.204.11\n\n[mfs_client]\n192.168.204.21\n\n[mfs_node]\n192.168.204.31\n\nEOF")]),s._v("\n\n这里仅仅介绍一些最常用的模块；\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 收集客户机的信息")]),s._v("\nansible all -m setup\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### ping 模块")]),s._v("\nansible all -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 执行命令")]),s._v("\nansible -i /etc/ansible/hosts "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -u root -m "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -l /root/'")]),s._v(" -k\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简化如下")]),s._v("\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -l /root/'")]),s._v(" -k\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### file 模块")]),s._v("\n\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/etc/fstab dest=/tmp/fstab state=link"')]),s._v("\n\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/tmp/fstab state=absent"')]),s._v("\n\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/tmp/test state=touch"')]),s._v("\n\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/tmp/d2 state=directory owner=root group=root mode=700"')]),s._v("\n\nansible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls /tmp -lh"')]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br")])]),t("h1",{attrs:{id:"六、gitlab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、gitlab"}},[s._v("#")]),s._v(" 六、gitlab")]),s._v(" "),t("h2",{attrs:{id:"_6-1-git命令入门"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-git命令入门"}},[s._v("#")]),s._v(" 6.1 git命令入门")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$WORKSPACE")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GitBranch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$from_commitid")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$to_commitid")]),s._v(" --name-only"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("compile_list.txt\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 获取commit id")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s"')]),s._v("  -2\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%H"')]),s._v("  -2\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%h"')]),s._v("  -2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 某文件的修改记录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log filename   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看某个文件的commit记录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log -p filename    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看文件每次提交的diff")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oneline filename "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出文件的所有改动历史")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" show 提交生成的一次哈希值 filename  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只查看某次提交的文件变化")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 取消add后的修改")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset HEAD + 文件名\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 取消commit后的修改")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout commitId 文件名\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h2",{attrs:{id:"_6-2-gitlab的安装使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-gitlab的安装使用"}},[s._v("#")]),s._v(" 6.2 gitlab的安装使用")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_6-8-jenkins-ci-cd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-8-jenkins-ci-cd"}},[s._v("#")]),s._v(" 6.8 Jenkins CI/CD")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## docker 安装 Jenkins")]),s._v("\ndocker search jenkins\ndocker pull jenkins/jenkins:lts\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v("  /opt/apps/jenkins -p\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v("   /opt/apps/jenkins\nll /opt/apps/\ndocker run -it --name wk-jenkinsci -v /opt/apps/jenkins:/var/jenkins_home -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000")]),s._v(":50000 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45000")]),s._v(":45000 jenkins/jenkins:lts\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看启动状态")]),s._v("\ndockeer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看启动端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -ntlp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/apps/jenkins/\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" copy_reference_file.log\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 升级站点项的的地址配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" hudson.model.UpdateCenter.xml\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 备份配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v("  hudson.model.UpdateCenter.xml  hudson.model.UpdateCenter.xml.default\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 【系统管理】【管理插件】【高级】升级站点项的地址修改成，")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 手动修改配置文件或后台修改http://ip:8080/pluginManager/advanced")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" center.json *\nhudson.model.UpdateCenter.xml:    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("url"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/url"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ldap配置系列二：jenkins集成ldap")]),s._v("\nhttps://www.cnblogs.com/zhaojiedi1992/p/zhaojiedi_liunx_52_ldap_for_jenkins.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## jenkins集成OpenLDAP认证")]),s._v("\nhttps://www.cnblogs.com/37Y37/p/9430272.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Jenkins学习七：Jenkins的授权和访问控制  ")]),s._v("\nhttps://www.cnblogs.com/yangxia-test/p/4368778.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Jenkins学习四：Jenkins 邮件配置")]),s._v("\nhttps://www.cnblogs.com/yangxia-test/p/4366172.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Jenkins 持续集成综合实战")]),s._v("\nhttps://kefeng.wang/2017/01/06/jenkins/\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br")])]),t("h1",{attrs:{id:"七、docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七、docker"}},[s._v("#")]),s._v(" 七、docker")]),s._v(" "),t("h2",{attrs:{id:"_7-1-配置阿里repo安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-配置阿里repo安装docker"}},[s._v("#")]),s._v(" 7.1 配置阿里repo安装docker")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 18.06.1-ce")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install -y yum-utils device-mapper-persistent-data lvm2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),s._v("\n\nyum makecache\nyum list docker-ce --showduplicates "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  docker-ce\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start docker\n\ndocker version\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 镜像的导入和导出")]),s._v("\ndocker save rancher/rke-tools:v0.1.59  rancher/coreos-etcd:v3.4.3-rancher1  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" etcd.tar\ndocker load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" etcd.tar\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## pip3 install docker-compose")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python36-devel python36-pip\npip3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-compose \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### docker-compose命令补全")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L https://raw.githubusercontent.com/docker/compose/1.27.4/contrib/completion/bash/docker-compose "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/bash_completion.d/docker-compose\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h3",{attrs:{id:"docker-base"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-base"}},[s._v("#")]),s._v(" docker base")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#1.停止所有的container，这样才能够删除其中的images：\ndocker stop $(docker ps -a -q)\n\n#如果想要删除所有container的话再加一个指令：\ndocker rm $(docker ps -a -q)\n\n#2.查看当前有些什么images\ndocker images\n\n#3.删除images，通过image的id来指定删除谁\ndocker rmi <image id>\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"dockers-volumes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockers-volumes"}},[s._v("#")]),s._v(" dockers volumes")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\t  \n增加这个\n    volumes:\n      - /etc/localtime:/etc/localtime\n      - /etc/timezone:/etc/timezone  \n\n\nhttps://segmentfault.com/a/1190000005612603\ndocker run -e TZ"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('"Asia/Shanghai" -v /etc/localtime:/etc/localtime:ro --name=tomcat tomcat:8.0.35-jre8')]),s._v("\n\n<p>通过这样的启动方式，就是OK了。<br>当然聪明人肯定不会自己每次都在启动的时候加这些配置，当然在基础镜像里面搞好咯。</p>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"docker-cp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-cp"}},[s._v("#")]),s._v(" docker cp")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 将主机/www/runoob目录拷贝到容器96f7f14e99ab的/www目录下。")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /www/runoob 96f7f14e99ab:/www/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 将主机/www/runoob目录拷贝到容器96f7f14e99ab中，目录重命名为www。")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /www/runoob 96f7f14e99ab:/www\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 将容器96f7f14e99ab的/www目录拷贝到主机的/tmp目录中。")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v("  96f7f14e99ab:/www /tmp/\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"_7-2-docker-compose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-docker-compose"}},[s._v("#")]),s._v(" 7.2 docker-compose")]),s._v(" "),t("h3",{attrs:{id:"_7-2-1-docker-flask"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-1-docker-flask"}},[s._v("#")]),s._v(" 7.2.1 docker flask")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/soymilk2019/p/11590117.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_7-2-2-docker-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-2-docker-nginx"}},[s._v("#")]),s._v(" 7.2.2 docker nginx")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker run --name testnginx  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),s._v(":80  -v /mnt/nz-docker/init/nginx/nz-docker.conf:/etc/nginx/conf.d/default.conf -v /mnt/nz-docker/client/:/usr/share/nginx/html/  nginx:1.12.2\n\ndocker run --name testnginx  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),s._v(":80  -v init/nginx/nz-docker.conf:/etc/nginx/conf.d/default.conf -v client/:/usr/share/nginx/html/  nginx:1.12.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"_7-5-elk-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-elk-docker"}},[s._v("#")]),s._v(" 7.5 elk - docker")]),s._v(" "),t("h3",{attrs:{id:"elk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elk"}},[s._v("#")]),s._v(" elk")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#确立自己原则的“五步原则”")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1、目标：我要什么？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2、计划：我该怎么做？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3、行动：我碰到了什么问题？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4、反思：什么原因？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5、改进：形成原则")]),s._v("\n\n├── docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose.yml\n├── docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stack.yml\n├── elasticsearch\n│   ├── config\n│   │   └── elasticsearch.yml\n│   └── Dockerfile\n├── extensions\n│   ├── apm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server\n│   ├── app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("search\n│   ├── curator\n│   ├── logspout\n├── kibana\n│   ├── config\n│   │   └── kibana.yml\n│   └── Dockerfile\n├── LICENSE\n├── logstash\n│   ├── config\n│   │   └── logstash.yml\n│   ├── Dockerfile\n│   └── pipeline\n│       └── logstash.conf\n└── README.md\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.2'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("elasticsearch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker.elastic.co/elasticsearch/elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" elasticsearch7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" discovery.type=single"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" esdata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/share/elasticsearch\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" elasticsearch\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9200"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9300"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kibana")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker.elastic.co/kibana/kibana"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kibana7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elasticsearch.hosts=http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kibana\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elasticsearch\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5601:5601"')]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logstash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker.elastic.co/logstash/logstash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" logstash7.2.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" logstash\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elasticsearch\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9600"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9600")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 5044"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5044")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("esdata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" local\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#链接：https://www.jianshu.com/p/24f6548de113")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://cloud.tencent.com/developer/article/1623379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://github.com/deviantony/docker-elk")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br")])]),t("h3",{attrs:{id:"logstash5-配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#logstash5-配置文件"}},[s._v("#")]),s._v(" logstash5 配置文件")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("input {\n    file {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            path")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "/var/log/httpd/access_log"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "http"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            start_position")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "beginning"')]),s._v("\n    }\n\n    file {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            path")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "/usr/local/nginx/logs/elk.access.log"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "nginx"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            start_position")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "beginning"')]),s._v("\n    }\n\n    file {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            path")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "/var/log/secure"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "secure"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            start_position")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "beginning"')]),s._v("\n    }\n\n    file {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            path")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "/var/log/messages"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "system"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            start_position")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "beginning"')]),s._v("\n    }\n}\n\n\noutput {\n    if [type] "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "http" {')]),s._v("\n        redis {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "192.168.1.202"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6379"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            data_type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "list"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'nagios_http' ")]),s._v("\n        }\n    }\n\n    if [type] "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "nginx" {')]),s._v("\n        redis {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "192.168.1.202"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6379"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            data_type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "list"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'nagios_nginx' ")]),s._v("\n        }\n    }\n\n    if [type] "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "secure" {')]),s._v("\n        redis {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "192.168.1.202"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6379"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            data_type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "list"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'nagios_secure' ")]),s._v("\n        }\n    }\n\n    if [type] "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "system" {')]),s._v("\n        redis {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "192.168.1.202"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6379"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "6"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            data_type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "list"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("            key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> 'nagios_system' ")]),s._v("\n        }\n    }\n} \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # /usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/full.conf")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br")])]),t("h3",{attrs:{id:"logstash7-部分配置参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#logstash7-部分配置参考"}},[s._v("#")]),s._v(" logstash7 部分配置参考")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("{ generator \n    { message "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> stdin codec => json }")]),s._v("\n}\n\nfilter {\n     mutate {\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("     \t rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> { "[foo][bar]" => "hello" }')]),s._v("\n\t\t }\n}\n\ninput{\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("  stdin{codec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> json_lines}")]),s._v("\n}\n\nfilter{\n  mutate{\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("    rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> {")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v('\t    "[f1][f2]"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('> "f3"')]),s._v("\n\t\t}\n\t}\n}\n\noutput{\n  stdout{\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("    codec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("> rubydebug{}")]),s._v("\n\t}\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h3",{attrs:{id:"kafka测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafka测试"}},[s._v("#")]),s._v(" kafka测试")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/xiao987334176/p/10075659.html\n\n\n/usr/local/kafka/bin/kafka-topics.sh --create --zookeeper 172.16.1.245:2181,172.16.1.243:2181,172.16.1.244:2181/kafka --replication-factor 3 --partitions 1 --topic test-topic\n\n/usr/local/kafka/bin/kafka-topics.sh --describe --zookeeper 172.16.1.245:2181,172.16.1.243:2181,172.16.1.244:2181/kafka --topic test-topic\n\n\n作者：杨赟快跑\n链接：https://www.jianshu.com/p/bdd9608df6b3\n\n\n/usr/local/kafka/bin/zookeeper-server-start.sh /usr/local/kafka/config/zookeeper.properties \n\n/usr/local/kafka/bin/kafka-server-start.sh /usr/local/kafka/config/server.properties &\n\n\nkill -9 `jps |grep afka |awk '{print $1}'`\n\ngrep -v '^$' server.properties |grep -v '^#'\n\nll /usr/local/kafka/zookeeper/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h3",{attrs:{id:"_7-5-4-filebeat7-yml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-4-filebeat7-yml"}},[s._v("#")]),s._v(" 7.5.4 filebeat7.yml")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("filebeat.inputs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Paths that should be crawled and fetched. Glob based paths.")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("paths")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /opt/log/games/"),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("*/*.log")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### Multiline options")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("multiline.pattern")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^[0-9]{4}'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("multiline.negate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("multiline.match")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" after\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#exclude_files: ["[0-9]{4}-[0-9]{2}-[0-9]{2}.[0-9]{3}.log$"]')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tags")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"games"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#================================ Logging =====================================")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Sets log level. The default log level is info.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Available log levels are: error, warning, info, debug")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logging.level")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" info\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logging.to_files")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logging.files")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /opt/log/filebeat7\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" filebeat.log\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######output for kafka#######")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("output.kafka")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka-s1.demain.com:9093"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka-s2.demain.com:9093"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka-s3.demain.com:9093"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("topic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GAMES-NZ'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("partition.round_robin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("reachable_only")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("required_acks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max_message_bytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000000")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.10"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keep_alive")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 60s\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("compression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gzip\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flush_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#######ssl########")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ssl.certificate_authorities")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/filebeat/keytool/myca.pem"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ssl.certificate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/filebeat/keytool/client1.pem"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ssl.key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/filebeat/keytool/client1-key.pem"')]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("h3",{attrs:{id:"_7-5-5-kibana-dev-tools"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-5-kibana-dev-tools"}},[s._v("#")]),s._v(" 7.5.5 kibana dev tools")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dev Tools")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 入门简介")]),s._v("\nhttps://www.cnblogs.com/ginb/p/6637236.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 官方api")]),s._v("\nhttps://www.elastic.co/guide/en/elasticsearch/reference/7.3/cat-health.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 集群信息")]),s._v("\nGET /_cluster/stats?pretty\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 分片大小")]),s._v("\nGET /_cat/shards?v\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GET _cat/shards?h=index,shard,prirep,state,unassigned.reason")]),s._v("\n\nindex                        shard prirep state           docs    store ip          node\ngames-nz_ydwx-2020.11.04     0     r      STARTED        12059    3.5mb 172.16.1.68 es_node-1\ngames-nz_ydwx-2020.11.04     0     p      STARTED        12059    3.4mb 172.16.1.64 es_node-3\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 列出所有索引")]),s._v("\nGET /_cat/indices?v\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GET /_cat/indices?v&s=pri.store.size")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GET /_cat/indices?v&s=pri.store.size:desc")]),s._v("\n\nhealth status index                        uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   games-nz_hf-2020.11.03       xWdlWq58RPSjpd7LcA2Ipw   1   1   26337502            0     18.8gb          9.4gb\ngreen  open   games-nz_hf-2020.11.09       Ozy8LS54TKuyEK8mmLMOqA   1   1    1808980            0      1.5gb        769.3mb\ngreen  open   audit-2020.10.25             AggdiOSwQXW0R0EWlNAUig   1   1        186            0    276.8kb        138.4kb\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 是否健康")]),s._v("\nGET /_cat/health?v\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 返回 bank 索引中的所有文档")]),s._v("\nGET /bank/_search?q"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("*&sort=account_number:asc&pretty")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ElasticSearch优化整理")]),s._v("\nhttps://www.jianshu.com/p/45a15ca1114f\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("h3",{attrs:{id:"_7-5-8-py-es-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-8-py-es-api"}},[s._v("#")]),s._v(" 7.5.8 py es api")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#pip3 install elasticsearch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://www.cnblogs.com/xiao987334176/p/10130712.html")]),s._v("\nfrom elasticsearch "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" Elasticsearch\nes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10.10.13.12'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("http_auth")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xiao'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("timeout")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nes.search"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("index"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'logstash-2015.08.20'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http_status_code:5* AND server_name:\"web1\"'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("from_")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'124119'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"_7-6-cdh-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-6-cdh-docker"}},[s._v("#")]),s._v(" 7.6 cdh - docker")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://www.cnblogs.com/piperck/p/9917118.html")]),s._v("\nhttps://www.cnblogs.com/piperck/p/9917118.html\nhttps://downloads.cloudera.com/demo_vm/docker/cloudera-quickstart-vm-5.13.0-0-beta-docker.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"_7-16-prometheus-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-16-prometheus-docker"}},[s._v("#")]),s._v(" 7.16 prometheus - docker")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_7-16-8-py-prom-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-16-8-py-prom-api"}},[s._v("#")]),s._v(" 7.16.8 py prom api")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"py-alert-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#py-alert-api"}},[s._v("#")]),s._v(" py alert api")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\nGET /-/healthy \nGET /-/ready  \nPOST /-/reload\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -u monitor:fosafer.com "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9093/-/healthy\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9093/-/reload\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -u monitor:fosafer.com "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9093/-/reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h1",{attrs:{id:"八、prometheus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八、prometheus"}},[s._v("#")]),s._v(" 八、Prometheus")]),s._v(" "),t("h2",{attrs:{id:"_8-1-prometheus安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-prometheus安装"}},[s._v("#")]),s._v(" 8.1 prometheus安装")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/prometheus/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"_8-2-promql语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-promql语法"}},[s._v("#")]),s._v(" 8.2 promql语法")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 11xxx 的在线redis")]),s._v("\nredis_up{redis_host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*:11[0-9]{3}"')]),s._v("}\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### prometheus监控 promsql的常用的几个的写法")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 监控CPU的使用率")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("avg "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("irate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_cpu{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"idle"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## CPU各个mode的占用率")]),s._v("\navg "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("irate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_cpu{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v("：cpu花了多少比率运行用户态空间，也就是用户进程占比。用户空间程序是不属于内核的任何进程。 \nsystem：CPU花了多少比率运行内核空间。所有进程和系统资源都有liunx内核处理。 \niowait：读写磁盘的操作比CPU的运行时间慢，CPU负载处理数据，而数据一般在磁盘上需要读到内存中才能处理。当CPU发起读写操作后，需要等着磁盘驱动器将数据读入内存，从而导致CPU等待一段时间无事可做。CPU处于这种状态的等待时间就是iowait时间。 \nidle：CPU处于空闲状态的时间比例 irq＆softirq：处理器为中断服务的时间。\nirq用于硬件中断，\nsoftirq用于软件中断。 \nNice：用户空间进程的CPU的调度优先级，可以通过调整期优先级来调整用户空间的优先级。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 机器一分钟的平均负载")]),s._v("\nnode_load1{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 内存使用率")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_memory_MemFree{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("node_memory_Cached{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("node_memory_Buffers{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node_memory_MemTotal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 带宽监控 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 上行带宽")]),s._v("\nsum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("irate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_network_receive_bytes{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("device"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bond.*?|lo"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 下行带宽")]),s._v("\nsum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("irate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_network_transmit_bytes{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("device"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bond.*?|lo"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 入包量")]),s._v("\nsum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_network_receive_bytes{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("device"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lo"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 出包量")]),s._v("\nsum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_network_transmit_bytes{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("device"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lo"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 磁盘使用率")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" node_filesystem_free{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fstype"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" node_filesystem_size{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fstype"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 平均请求数")]),s._v("\nrate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.3.51.200:9100"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n原文：https:"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//blog.csdn.net/sunyuhua_keyboard/article/details/81302165 ")]),s._v("\n版权声明：本文为博主原创文章，转载请附上博文链接！\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 函数列表一些函数有默认的参数，例如：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("year")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nv是参数值，instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector是参数类型。\nvector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("是默认值。\n\nabs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nabs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("返回输入向量的所有样本的绝对值。\n\nabsent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nabsent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("，如果赋值给它的向量具有样本数据，则返回空向量；如果传递的瞬时向量参数没有样本数据，则返回不带度量指标名称且带有标签的样本值为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("的结果当监控度量指标时，如果获取到的样本数据是空的， 使用absent方法对告警是非常有用的\n\nabsent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nonexistent{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myjob"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# => key: value = {job="myjob"}: ')]),s._v("\nabsent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nonexistent{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myjob"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# => {job="myjob"} 1 so smart !')]),s._v("\nabsent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nonexistent{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myjob"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => key:value {}: 0")]),s._v("\n\nceil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nceil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 是一个向上舍入为最接近的整数。\n\nchanges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nchanges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 输入一个范围向量， 返回这个范围向量内每个样本数据值变化的次数。\n\nclamp_max"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nclamp_max"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" max scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个瞬时向量和最大值，样本数据值若大于max，则改为max，否则不变\n\nclamp_min"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nclamp_min"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个瞬时向量和最大值，样本数据值小于min，则改为min。否则不变\n\ncount_saclar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncount_scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 输入一个瞬时向量，返回"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scalar"')]),s._v(": 样本个数。而"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个瞬时向量，返回"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("向量：样本个数，其中结果中的向量允许通过"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v("条件分组。\n\nday_of_month"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nday_of_month"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，返回被给定UTC时间所在月的第几天。返回值范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("。\n\nday_of_week"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nday_of_week"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，返回被给定UTC时间所在周的第几天。返回值范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("表示星期天。\n\ndays_in_month"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndays_in_month"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，返回当月一共有多少天。返回值范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.")]),s._v("\n\ndelta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndelta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，计算一个范围向量v的第一个元素和最后一个元素之间的差值。返回值："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("度量指标：差值下面这个表达式例子，返回过去两小时的CPU温度差：delta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cpu_temp_celsius{host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zeus"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("delta函数返回值类型只能是gauges。\n\nderiv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nderiv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，计算一个范围向量v中各个时间序列二阶导数，使用简单线性回归deriv二阶导数返回值类型只能是gauges。\n\ndrop_common_labels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndrop_common_labels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个瞬时向量，返回值是"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("度量指标：样本值，其中度量指标是去掉了具有相同标签。 \n例如：\nhttp_requests_total{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} : "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \nhttp_requests_total{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"post"')]),s._v("} : "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n返回值: http_requests_total{method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} : "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" http_requests_total{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"post"')]),s._v("} : "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\nexp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nexp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个瞬时向量"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 返回各个样本值的e指数值，即为e"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v("N次方。特殊情况如下所示：Exp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("inf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Inf Exp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NaN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NaNfloor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("floor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，与ceil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数相反。 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.3")]),s._v(" 为 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 。\n\nhistogram_quantile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhistogram_quatile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("φ "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("float")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 函数计算b向量的φ"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("直方图 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ≤ φ ≤ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 。参考中文文献"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("https:"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//www.howtoing.com/how-to-query-prometheus-on-ubuntu-14-04-part-2/]")]),s._v("\n\nholt_winters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nholt_winters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sf scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tf scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数基于范围向量v，生成事件序列数据平滑值。平滑因子sf越低"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 对老数据越重要。趋势因子tf越高，越多的数据趋势应该被重视。"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" sf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。 holt_winters仅用于gaugeshour"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("hour")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数返回被给定UTC时间的当前第几个小时，时间范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("。\n\nidelta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nidelta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入一个范围向量，返回"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标： 每最后两个样本值差值。\n\nincrease"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nincrease"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数， 输入一个范围向量，返回："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("last")]),s._v("值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("first")]),s._v("值，自动调整单调性，\n如：服务实例重启，则计数器重置。与delta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("不同之处在于delta是求差值，而increase返回最后一个减第一个值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("可为正为负。下面的表达式例子，返回过去"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("分钟，连续两个时间序列数据样本值的http请求增加值。\nincrease"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api-server"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("increase的返回值类型只能是counters，主要作用是增加图表和数据的可读性，使用rate记录规则的使用率，以便持续跟踪数据样本值的变化。\n\nirateirate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 输入：范围向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标： "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("last")]),s._v("值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("last")]),s._v("前一个值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("时间戳差值。它是基于最后两个数据点，自动调整单调性， 如：服务实例重启，则计数器重置。下面表达式针对范围向量中的每个时间序列数据，返回两个最新数据点过去"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("分钟的HTTP请求速率。\n\nirate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api-server"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("irate只能用于绘制快速移动的计数器。因为速率的简单更改可以重置"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v("子句，利用警报和缓慢移动的计数器，完全由罕见的尖峰组成的图形很难阅读。\n\nlabel_replace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("对于v中的每个时间序列，\nlabel_replace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dst_label string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" replacement string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" src_label string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" regex string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 将正则表达式与标签值src_label匹配。如果匹配，则返回时间序列，标签值dst_label被替换的扩展替换。$"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("替换为第一个匹配子组，$"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("替换为第二个等。如果正则表达式不匹配，则时间序列不会更改。另一种更容易的理解是：label_replace函数，输入：瞬时向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标： 值（要替换的内容：首先，针对src_label标签，对该标签值进行regex正则表达式匹配。如果不能匹配的度量指标，则不发生任何改变；否则，如果匹配，则把dst_label标签的标签纸替换为replacement 下面这个例子返回一个向量值a带有foo标签： \n\nlabel_replace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("up{job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api-server"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" serice"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a:c"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"service"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(.):."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("计算瞬时向量v中所有样本数据的自然对数。特殊例子：ln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Inf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Inf ln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Inf ln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NaN ln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NaN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NaN\n\nlog2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlog2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数计算瞬时向量v中所有样本数据的二进制对数。\n\nlog10"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlog10"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数计算瞬时向量v中所有样本数据的"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("进制对数。相当于ln"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("minute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("minute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数返回给定UTC时间当前小时的第多少分钟。结果范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("。\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("month")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("month")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数返回给定UTC时间当前属于第几个月，结果范围："),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("。\n\npredict_linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npredict_linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" t scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("预测函数，输入：范围向量和从现在起t秒后，输出：不带有度量指标，只有标签列表的结果值。例如：predict_linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n结果：\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query_range"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4283.449995397104")]),s._v("\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"static"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.99999999999999")]),s._v("\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("130.90381188596754")]),s._v("\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label_values"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\nrate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 输入：范围向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 不带有度量指标，且只有标签列表："),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("last")]),s._v("值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("first")]),s._v("值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("时间差srate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("结果：{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label_values"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query_range"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.003389830508474576")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"422"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"static"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"400"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("rate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数返回值类型只能用counters， 当用图表显示增长缓慢的样本数据时，这个函数是非常合适的。注意：当rate函数和聚合方式联合使用时，一般先使用rate函数，再使用聚合操作"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 否则，当服务实例重启后，rate无法检测到counter重置。\n\nresets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 输入：一个范围向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("没有度量指标，且有标签列表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("在这个范围向量中每个度量指标被重置的次数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("。在两个连续样本数据值下降，也可以理解为counter被重置。 示例：resets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http_requests_total"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("结果：{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label_values"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query_range"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"422"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"static"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("{code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"400"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"120.77.65.193:9090"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get"')]),s._v("} "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("resets只能和counters一起使用。\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" to_nearest "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，与ceil和floor函数类似，输入：瞬时向量，输出：指定整数级的四舍五入值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 如果不指定，则是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("以内的四舍五入。\n\nscalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nscalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 输入：瞬时向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" “scalar”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 样本值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("如果度量指标样本数量大于"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("或者等于"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 则样本值为NaN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 否则，样本值本身"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nsort"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsort"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入：瞬时向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标：样本值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("升序排列"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nsort_desc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsort_desc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入：瞬时向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标：样本值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("降序排列"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nsqrt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsqrt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，输入：瞬时向量，输出："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 度量指标： 样本值的平方根\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，返回从"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1970")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v("到现在的秒数，注意：它不是直接返回当前时间，而是时间戳\n\nvector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nvector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数，返回："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" {}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 传入参数值\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("year")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("year")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" instant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 返回年份。_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("下面的函数列表允许传入一个范围向量，返回一个带有聚合的瞬时向量:\navg_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的平均值。\nmin_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的最小值。\nmax_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的最大值。\nsum_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的求和值。\ncount_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的样本数据个数。\nquantile_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("scalar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的样本数据值分位数，φ"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("quantile "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ≤ φ ≤ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nstddev_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的总体标准偏差。\nstdvar_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("range"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 范围向量内每个度量指标的总体标准方差。\n转自：https:"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//github.com/1046102779/prometheus/blob/master/prometheus/querying/functions.md")]),s._v("\nhttps:"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//github.com/prometheus/prometheus/blob/master/docs/querying/functions.md")]),s._v("\n\n\nirate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_cpu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nirate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_load1{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.1.43:9301"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prometheus_http_request_duration_seconds_count{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"129.211.99.141:9090"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmax_over_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prometheus_http_request_duration_seconds_count{instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"129.211.99.141:9090"')]),s._v("}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br"),t("span",{staticClass:"line-number"},[s._v("148")]),t("br"),t("span",{staticClass:"line-number"},[s._v("149")]),t("br"),t("span",{staticClass:"line-number"},[s._v("150")]),t("br"),t("span",{staticClass:"line-number"},[s._v("151")]),t("br"),t("span",{staticClass:"line-number"},[s._v("152")]),t("br"),t("span",{staticClass:"line-number"},[s._v("153")]),t("br"),t("span",{staticClass:"line-number"},[s._v("154")]),t("br"),t("span",{staticClass:"line-number"},[s._v("155")]),t("br"),t("span",{staticClass:"line-number"},[s._v("156")]),t("br"),t("span",{staticClass:"line-number"},[s._v("157")]),t("br"),t("span",{staticClass:"line-number"},[s._v("158")]),t("br"),t("span",{staticClass:"line-number"},[s._v("159")]),t("br"),t("span",{staticClass:"line-number"},[s._v("160")]),t("br"),t("span",{staticClass:"line-number"},[s._v("161")]),t("br"),t("span",{staticClass:"line-number"},[s._v("162")]),t("br"),t("span",{staticClass:"line-number"},[s._v("163")]),t("br"),t("span",{staticClass:"line-number"},[s._v("164")]),t("br"),t("span",{staticClass:"line-number"},[s._v("165")]),t("br"),t("span",{staticClass:"line-number"},[s._v("166")]),t("br"),t("span",{staticClass:"line-number"},[s._v("167")]),t("br"),t("span",{staticClass:"line-number"},[s._v("168")]),t("br"),t("span",{staticClass:"line-number"},[s._v("169")]),t("br"),t("span",{staticClass:"line-number"},[s._v("170")]),t("br"),t("span",{staticClass:"line-number"},[s._v("171")]),t("br"),t("span",{staticClass:"line-number"},[s._v("172")]),t("br"),t("span",{staticClass:"line-number"},[s._v("173")]),t("br"),t("span",{staticClass:"line-number"},[s._v("174")]),t("br"),t("span",{staticClass:"line-number"},[s._v("175")]),t("br"),t("span",{staticClass:"line-number"},[s._v("176")]),t("br"),t("span",{staticClass:"line-number"},[s._v("177")]),t("br"),t("span",{staticClass:"line-number"},[s._v("178")]),t("br"),t("span",{staticClass:"line-number"},[s._v("179")]),t("br"),t("span",{staticClass:"line-number"},[s._v("180")]),t("br"),t("span",{staticClass:"line-number"},[s._v("181")]),t("br"),t("span",{staticClass:"line-number"},[s._v("182")]),t("br"),t("span",{staticClass:"line-number"},[s._v("183")]),t("br")])]),t("h2",{attrs:{id:"_8-5-grafana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-grafana"}},[s._v("#")]),s._v(" 8.5 Grafana")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("常用模板编号：\nnode-exporter: cn/8919,en/11074\nk8s: 13105\ndocker: 12831\nalertmanager: 9578\nblackbox_exportre: 9965\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h1",{attrs:{id:"九、kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#九、kubernetes"}},[s._v("#")]),s._v(" 九、kubernetes")]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://www.kubernetes.org.cn/deployment",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes（k8s）中文文档 名称解释：Deployment_Kubernetes中文社区"),t("OutboundLink")],1)])]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####################")]),s._v('\nhttps://zhuanlan.zhihu.com/p/53260098\n\n怎么样？是不是很神奇？\n\n所以，Docker的第二句口号就是："Build once，Run anywhere（搭建一次，到处能用）"。\n\nDocker技术的三大核心概念，分别是：\n\n镜像（Image）\n容器（Container）\n仓库（Repository）\n\n一个K8S系统，通常称为一个K8S集群（Cluster）,主要包括两个部分：\n\n一个Master节点（主节点）\n一群Node节点（计算节点）\n\nMaster节点包括: API Server、Scheduler、Controller manager、etcd。\n\nAPI Server是整个系统的对外接口，供客户端和其它组件调用，相当于"营业厅"。\n\nScheduler负责对集群内部的资源进行调度，相当于"调度室"。\n\nController manager负责管理控制器，相当于"大总管"。\n\n\nNode节点包括Docker、kubelet、kube-proxy、Fluentd、kube-dns（可选），还有就是Pod。\n\nPod是Kubernetes最基本的操作单元。一个Pod代表着集群中运行的一个进程，它内部封装了一个或多个紧密相关的容器。除了Pod之外，K8S还有一个Service的概念，一个Service可以看作一组提供相同服务的Pod的对外访问接口。这段不太好理解，跳过吧。\n\nDocker，不用说了，创建容器的。\n\nKubelet，主要负责监视指派到它所在Node上的Pod，包括创建、修改、监控、删除等。\n\nKube-proxy，主要负责为Pod对象提供代理。\n\nFluentd，主要负责日志收集、存储与查询。\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("h2",{attrs:{id:"_9-1-kubeadm-安装k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-kubeadm-安装k8s"}},[s._v("#")]),s._v(" 9.1 kubeadm 安装k8s")]),s._v(" "),t("h3",{attrs:{id:"_9-1-1-机器初始化（准备环境）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-1-机器初始化（准备环境）"}},[s._v("#")]),s._v(" 9.1.1 机器初始化（准备环境）")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 关闭防火墙：")]),s._v("\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 关闭selinux：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/enforcing/disabled/'")]),s._v(" /etc/selinux/config \nsetenforce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 关闭swap：")]),s._v("\nswapoff -a  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#临时")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/swap/ s/^\\(.*\\)$/#"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\1"}},[s._v("\\1")]),s._v("/g'")]),s._v(" /etc/fstab\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### vim /etc/fstab  永久")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 添加主机名与IP对应关系（记得设置主机名）：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## hostnamectl --static set-hostname  k8s-node02")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n192.168.204.140 k8s-master\n192.168.204.141 k8s-node1\n192.168.204.142 k8s-node2\n\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 将桥接的IPv4流量传递到iptables的链：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/sysctl.d/k8s.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF")]),s._v("\nsysctl --system\n\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y conntrack ntpdate ntp ipvsadm ipset jq iptables "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" sysstat libseccomp "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### repo配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/yum.repo.d/bak\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repo.d/*.repo /etc/yum.repo.d/bak\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/epel.repo  http://mirrors.aliyun.com/repo/epel-7.repo\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/CentOS-Base.repo  http://mirrors.aliyun.com/repo/Centos-7.repo\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 安装指定版本的docker")]),s._v("\nyum makecache\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.06.1.ce-3.el7\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start docker\n\ndocker --version\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 配置k8s repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/kubernetes.repo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 4.3 安装kubeadm，kubelet和kubectl")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 由于版本更新频繁，这里指定版本号部署：")]),s._v("\n\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y kubelet-1.15.2 kubeadm-1.15.2 kubectl-1.15.2\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" kubelet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start kubelet\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br")])]),t("h3",{attrs:{id:"_9-1-2-master部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-2-master部署"}},[s._v("#")]),s._v(" 9.1.2 master部署")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 在192.168.204.140 （Master）执行。")]),s._v("\n\nkubeadm init "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --apiserver-advertise-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --image-repository registry.aliyuncs.com/google_containers "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --kubernetes-version v1.15.0 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --service-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".0.0/16 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --pod-network-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".0.0/16\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 由于默认拉取镜像地址k8s.gcr.io国内无法访问，这里指定阿里云镜像仓库地址。")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 使用kubectl工具：")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\nkubectl get nodes\nkubectl get pods -A\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 6. 安装Pod网络插件（CNI）")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/a70459be0084506e4ec919aa1c1141408878db11b/Documentation/kube-flannel.yml")]),s._v("\n\nkubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://www.cnblogs.com/hongdada/p/11395200.html")]),s._v("\ndocker pull quay-mirror.qiniu.com/coreos/flannel:v0.11.0-amd64\ndocker tag quay-mirror.qiniu.com/coreos/flannel:v0.11.0-amd64 quay.io/coreos/flannel:v0.11.0-amd64\ndocker rmi quay-mirror.qiniu.com/coreos/flannel:v0.11.0-amd64 \n\n海外服务器执行：\ndocker save gcr.io/google_containers/kubernetes-dashboard-amd64:v1.5.1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dashboard.tar\ndocker save registry.access.redhat.com/rhel7/pod-infrastructure:latest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" podinfrastructure.tar\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" *.tar root@你国内的外网IP:/home/tar\n各个node上执行：\ndocker load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" dashboard.tar\ndocker load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" podinfrastructure.tar\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master01 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -A -o wide")]),s._v("\nNAMESPACE     NAME                                   READY   STATUS                  RESTARTS   AGE   IP                NODE           NOMINATED NODE   READINESS GATES\nkube-system   coredns-bccdc95cf-rbpfs                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   coredns-bccdc95cf-tsdf6                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   etcd-k8s-master01                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   kube-apiserver-k8s-master01            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   kube-controller-manager-k8s-master01   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   kube-flannel-ds-amd64-4jqnj            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Init:ImagePullBackOff   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          19m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   kube-proxy-rpl4s                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nkube-system   kube-scheduler-k8s-master01            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          28m   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140   k8s-master01   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 确保能够访问到quay.io这个registery。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 如果下载失败，可以改成这个镜像地址：lizhenliang/flannel:v0.11.0-amd64")]),s._v("\n\nkubectl  delete pods kube-flannel-ds-amd64-4jqnj -n kube-system\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br")])]),t("h3",{attrs:{id:"_9-1-3-node部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-3-node部署"}},[s._v("#")]),s._v(" 9.1.3 node部署")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 在192.168.204.141/142 （Node）执行。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 向集群添加新节点，执行在kubeadm init输出的kubeadm join命令：")]),s._v("\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.140:6443 --token vr3h2n.8tq4754f0qugtesu "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --discovery-token-ca-cert-hash sha256:a300b8ebdb144938a3aabbba76bc98968c9546ebb9083445b764ea037b172503\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## master 执行 get pods -A  发现flannel自动注册")]),s._v("\nkube-system   kube-flannel-ds-amd64-m8vvw            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          35s\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_9-1-4-测试集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-4-测试集群"}},[s._v("#")]),s._v(" 9.1.4 测试集群")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 在Kubernetes集群中创建一个pod，验证是否正常运行：")]),s._v("\n\nkubectl create deployment nginx --image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nkubectl expose deployment nginx --port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort\nkubectl get pod,svc\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 访问地址：http://NodeIP:Port  ")]),s._v("\nhttp://192.168.204.135:30586/\t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_9-1-5-部署dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-5-部署dashboard"}},[s._v("#")]),s._v(" 9.1.5 部署dashboard")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker pull sacred02/kubernetes-dashboard-amd64:v1.10.1\ndocker tag sacred02/kubernetes-dashboard-amd64:v1.10.1 k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1\ndocker rmi sacred02/kubernetes-dashboard-amd64:v1.10.1\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 默认镜像国内无法访问，修改镜像地址为： lizhenliang/kubernetes-dashboard-amd64:v1.10.1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 默认Dashboard只能集群内部访问，修改 Service 为 NodePort 类型，暴露到外部：")]),s._v("\n\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    k8s-app: kubernetes-dashboard\n  name: kubernetes-dashboard\n  namespace: kube-system\nspec:\n  type: NodePort\n  ports:\n    - port: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("\n      targetPort: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n      nodePort: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30001")]),s._v("\n  selector:\n    k8s-app: kubernetes-dashboard\n\nkubectl apply -f kubernetes-dashboard.yaml\n\n访问地址：http://NodeIP:30001\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建service account并绑定默认cluster-admin管理员集群角色：")]),s._v("\n\nkubectl create serviceaccount dashboard-admin -n kube-system\nkubectl create clusterrolebinding dashboard-admin --clusterrole"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cluster-admin --serviceaccount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kube-system:dashboard-admin\nkubectl describe secrets -n kube-system "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl -n kube-system get secret "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dashboard-admin/{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n使用输出的token登录Dashboard。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 更新https证书有效期，解决只能由火狐浏览器访问，其他浏览器无法访问问题")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### https://www.cnblogs.com/xiajq/p/11322568.html")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" key\nopenssl genrsa -out dashboard.key "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" \n\nopenssl req -new -out dashboard.csr -key dashboard.key -subj "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/CN=172.19.0.48'")]),s._v("\n\nopenssl x509 -req -in dashboard.csr -signkey dashboard.key -out dashboard.crt \n\nkubectl delete secret kubernetes-dashboard-certs -n kube-system\n\nkubectl create secret generic kubernetes-dashboard-certs --from-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dashboard.key --from-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dashboard.crt -n kube-system  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新的证书")]),s._v("\n\nkubectl delete pod kubernetes-dashboard-746dfd476-b2r5f -n kube-system    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启服务")]),s._v("\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br")])]),t("h2",{attrs:{id:"_9-2-rancher安装k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-rancher安装k8s"}},[s._v("#")]),s._v(" 9.2 rancher安装k8s")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.06.1.ce-3.el7\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 18.06.1-ce")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo\nyum makecache\nyum list docker-ce --showduplicates "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n\nyum    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.09.1.ce-3.el7\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start docker\n\ndocker version\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /opt/apps/rancher\n\ndocker run -d --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unless-stopped -v /opt/apps/rancher:/var/lib/rancher/ -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(":443 rancher/rancher\n\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run -d --privileged --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unless-stopped --net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("host -v /etc/kubernetes:/etc/kubernetes -v /var/run:/var/run rancher/rancher-agent:v2.4.5 --server https://192.168.204.222 --token 8jnbplvpmfh2whfl8vdjrlqzpnjj8nmvvxstrq9bkh7zc9d2g54xgm --ca-checksum 4cf464173b12436e203b80dc537a1db4543e87c6cf17c4a2e34bfde51b843c37 --node-name master222 --internal-address "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.222 --etcd --controlplane --worker\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run -d --privileged --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unless-stopped --net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("host -v /etc/kubernetes:/etc/kubernetes -v /var/run:/var/run rancher/rancher-agent:v2.4.5 --server https://192.168.204.222 --token xc8v54vtsfc4gv8x6lvzjsdh8l9h8jd6jgkvtngv9rc724fm96wqk2 --ca-checksum ca0c7092f76162c056f79a7bdffe439cdfd7f74b298e2831b3d9792f0fda798f --node-name master222 --internal-address "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".204.222 --etcd --controlplane --worker\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 镜像的导入和导出")]),s._v("\ndocker save rancher/rke-tools:v0.1.59 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" tools.tar\ndocker save rancher/coreos-etcd:v3.4.3-rancher1  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" etcd.tar\ndocker load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" etcd.tar\ndocker load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" tools.tar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h2",{attrs:{id:"_9-9-排除-001-cluster-dns问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-9-排除-001-cluster-dns问题"}},[s._v("#")]),s._v(" 9.9 排除 001 cluster-dns问题")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("修改/usr/lib/systemd/system/kubelet.service  参数：cluster-dns  cluster-domain \nkubectl  describe pod kubernetes-dashboard-746dfd476-mdv5n  -n kube-system\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 报错：kubelet does not have ClusterDNS IP configured and cannot create PodJ解决方案")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@VM_0_48_centos dashboard]")]),s._v("# cat /usr/lib/systemd/system/kubelet.service\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Unit]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Description")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("Kubernetes Kubelet")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("After")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("docker.service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Requires")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("docker.service")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Service]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EnvironmentFile")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/opt/kubernetes/cfg/kubelet")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/opt/kubernetes/bin/kubelet $KUBELET_OPTS")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Restart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("on-failure")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KillMode")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("process")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Install]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WantedBy")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("multi-user.target")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[root@VM_0_48_centos dashboard]")]),s._v("# cat /opt/kubernetes/cfg/kubelet\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KUBELET_OPTS")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('"--logtostderr=true \\')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--v")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("4 \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--hostname-override")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("172.19.0.48 \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--cluster-dns")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("10.0.0.2 \\             ### 配置dns")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--cluster-domain")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("cluster.local \\   ###配置域名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--kubeconfig")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/opt/kubernetes/cfg/kubelet.kubeconfig \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--bootstrap-kubeconfig")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/opt/kubernetes/cfg/bootstrap.kubeconfig \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--cert-dir")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/opt/kubernetes/ssl \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("--pod-infra-container-image")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('registry.cn-hangzhou.aliyuncs.com/google-containers/pause-amd64:3.0"')]),s._v("\n\n修改完以后，重启服务发现正常\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## k8s dashboard 安装和证书更新")]),s._v("\nhttps://www.cnblogs.com/xiajq/p/11322568.html\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Kubernetes的Deployment与ReplicaSet了解与基础操作")]),s._v("\nhttps://cloud.tencent.com/developer/article/1347201\nDeployment是新一代用于Pod管理的对象，与Replication Controller相比，它提供了更加完善的功能，使用起来更加简单方便。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 比较 Deployment 与 ReplicaSet")]),s._v("\n　　ReplicaSet 也是用来管理多个 Pod 的副本，那么 Deployment 和 ReplicaSet 的区别在哪里呢？\n　　当我们创建了 Deployment 之后，实际上也创建了 ReplicaSet，所以说 Deployment 管理着 ReplicaSet（实际上 Deployment 比 ReplicaSet 有着更多功能）\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Deployment 管理着 ReplicaSet，因此当 Deployment 伸缩时，由它管理的 ReplicaSet 也会发生伸缩：")]),s._v("\n\n但反过来，如果我们直接伸缩 ReplicaSet，那么 Deployment 也会相应发生伸缩吗？答案是不会的。\n\nkubectl  apply -f nginx-deployment.yaml\n\nkubectl  rollout status deployments nginx-deployment\n\nkubectl  edit deploy nginx-service\n\nkubectl  rollout history deployment nginx-service\n\nkubectl  rollout history deployment nginx-service --revision"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("2")]),s._v("\nkubectl  rollout history deployment nginx-service --revision"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 假设我们想回滚到上一个版本，上一个版本的版本号是 1，那么可以执行：")]),s._v("\n\nkubectl  rollout undo deployments nginx-service --to-revision"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## k8s证书")]),s._v("\nhttps://www.cnblogs.com/centos-python/articles/11043570.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## k8s 使用篇 - deployment")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://my.oschina.net/u/914655/blog/1635492")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://blog.csdn.net/weixin_34268753/article/details/89586977")]),s._v("\nDeployment管理Pods和ReplicaSets，提供声明式更新。和老的ReplicationController（命令式管理）对应，发展趋势是取代老的，所以后面也不会起文章单独讨论ReplicationController了。\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br")])]),t("h1",{attrs:{id:"项目实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目实战"}},[s._v("#")]),s._v(" "),t("strong",[s._v("项目实战")])]),s._v(" "),t("h2",{attrs:{id:"_000-lvs-keepalive双机热备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_000-lvs-keepalive双机热备"}},[s._v("#")]),s._v(" 000 LVS+Keepalive双机热备")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## keepalived工作原理  https://www.cnblogs.com/xiangsikai/p/8436431.html")]),s._v("\n　　keepalived是集群管理中保证集群高可用的一个服务软件，其功能类似于heartbeat，用来防止单点故障。\n\n　　keepalived是以VRRP协议为实现基础的，VRRP全称Virtual Router Redundancy Protocol，即虚拟路由冗余协议。\n\n　　虚拟路由冗余协议，可以认为是实现路由器高可用的协议，即将N台提供相同功能的路由器组成一个路由器组，这个组里面有一个master和多个backup，master上面有一个对外提供服务的vip（该路由器所在局域网内其他机器的默认路由为该vip），master会发组播，当backup收不到vrrp包时就认为master宕掉了，这时就需要根据VRRP的优先级来选举一个backup当master。这样的话就可以保证路由器的高可用了。\n\n　　keepalived主要有三个模块，分别是core、check和vrrp。core模块为keepalived的核心，负责主进程的启动、维护以及全局配置文件的加载和解析。check负责健康检查，包括常见的各种检查方式。vrrp模块是来实现VRRP协议的。\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 安装keepalived")]),s._v("\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" keepalived* ipvsadm\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 加载内核模块")]),s._v("\nmodprobe ip_vs\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 备份配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/keepalived/keepalived.conf /etc/keepalived/keepalived.conf_bak\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/keepalived/keepalived.conf\nglobal_defs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    router_id LVS_TEST    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务器名字")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nvrrp_instance VI_1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    state MASTER    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置主备，备用机此配置项为BACKUP")]),s._v("\n    interface enp0s3    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定接口")]),s._v("\n    virtual_router_id "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定路由ID，主备必须一样")]),s._v("\n    priority "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置优先级，主略高于备份")]),s._v("\n    advert_int "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置检查时间")]),s._v("\n    authentication "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        auth_type PASS    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置验证加密方式")]),s._v("\n        auth_type "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置验证密码")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    virtual_ipaddress "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.200\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nvirtual_server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.200 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    delay_loop "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#健康检查时间")]),s._v("\n    lb_algo rr    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#LVS调度算法")]),s._v("\n    lb_kind DR   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#LVS工作模式")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("persistence "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否保持连接，！不保持")]),s._v("\n    protocol TCP    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务采用TCP协议")]),s._v("\n    real_server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.113 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        weight "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#权重")]),s._v("\n        TCP_CHECK "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TCP检查")]),s._v("\n            connect_port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#检查端口80")]),s._v("\n            connect_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#超时时间3秒")]),s._v("\n            nb_get_retry "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重试次数3次")]),s._v("\n            delay_before_retry "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重试间隔4秒")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    real_server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.150 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        weight "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        TCP_CHECK "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            connect_port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n            connect_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n            nb_get_retry "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n            delay_before_retry "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 启动keepalived")]),s._v("\nsystemctl restart keepalived "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" keepalived\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br")])]),t("h2",{attrs:{id:"_001-haproxy-keepalived-基于四层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_001-haproxy-keepalived-基于四层"}},[s._v("#")]),s._v(" 001 haproxy+keepalived 基于四层")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://www.cnblogs.com/MacoLee/p/5853356.html")]),s._v("\n\n HAProxy的balance8种负载均衡算法：\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".roundrobin "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 基于权重轮循。\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".static-rr "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 基于权重轮循。静态算法，运行时改变无法生效\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".source "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 基于请求源IP的算法。对请求的源IP进行hash运算，然后将结果与后端服务器的权重总数想除后转发至某台匹配服务器。使同一IP客户端请求始终被转发到某特定的后端服务器。\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".leastconn "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 最小连接。（适合数据库负载均衡，不适合会话短的环境） \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".uri "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 对部分或整体URI进行hash运算，再与服务器的总权重想除，最后转发到匹配后端。\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".uri_param "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 根据URL路径中参数进行转发，保证在后端服务器数量不变的情况下，同一用户请求分发到同一机器。\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".hdr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 根据http头转发，如果不存在http头。则使用简单轮循。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"_002-nginx-keepalived-基于七层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_002-nginx-keepalived-基于七层"}},[s._v("#")]),s._v(" 002 nginx+keepalived 基于七层")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_003-vue-git-docker-jenkins-cicd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_003-vue-git-docker-jenkins-cicd"}},[s._v("#")]),s._v(" 003 vue+git+docker+jenkins cicd")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/xiao987334176/p/12345304.html")]),s._v(" "),t("h2",{attrs:{id:"_004-jenkins-gitlab-harbor-rancher-k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_004-jenkins-gitlab-harbor-rancher-k8s"}},[s._v("#")]),s._v(" 004 Jenkins+Gitlab+Harbor+Rancher+k8s")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/xiao987334176/p/13074198.html")]),s._v(" "),t("h2",{attrs:{id:"_005-docker通过efk（elasticsearch-fluentd-kibana）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_005-docker通过efk（elasticsearch-fluentd-kibana）"}},[s._v("#")]),s._v(" 005 Docker通过EFK（Elasticsearch + Fluentd + Kibana）")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/xiao987334176/p/12376980.html")]),s._v(" "),t("h2",{attrs:{id:"_006-基于docker-搭建prometheus-grafana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_006-基于docker-搭建prometheus-grafana"}},[s._v("#")]),s._v(" 006 基于docker 搭建Prometheus+Grafana")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/xiao987334176/p/9930517.html\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 几点思考")]),s._v("\n1、node 主机的自动发现，端口自动发现\n2、redis 自动发现\n3、mysql 自动发现\n4、alertmanager \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h1",{attrs:{id:"附：-tips"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附：-tips"}},[s._v("#")]),s._v(" 附： tips")]),s._v(" "),t("h2",{attrs:{id:"_001-时间格式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_001-时间格式化"}},[s._v("#")]),s._v(" 001 时间格式化")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" datetime\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#获得当前时间")]),s._v("\nnow "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" datetime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("datetime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("now"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("这是时间数组格式\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#转换为指定的格式:")]),s._v("\notherStyleTime "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" now"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strftime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%Y%m%d_%H%M%S"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" time\nnow_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strftime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%Y-%m-%d %H:%M:%S'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bash")]),s._v("\nNow_Time"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("Y"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("d"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("H"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("M"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("`\nNowStamp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("`\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"当前时间和当前时间戳"')]),s._v(" $Now_Time $NowStamp\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"_002-check-url-sh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_002-check-url-sh"}},[s._v("#")]),s._v(" 002 check_url.sh")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####################################################")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Author: channel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Github: https://github.com/yes5144")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Time: 2018-03-10 16:05:56# Version: V1.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Description: This is just a test scripts")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####################################################")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/init.d/functions\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("check_count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("url_list")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http://www.baidu.com http://192.168.204.123 http://www.google.cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("wait")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'after 3 seconds, check url.'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("check_url")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("`echo ${#url_list["),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("]}`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -o /dev/null -T "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" --tries"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --spider "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${url_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${url_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("}")]),s._v('"')]),s._v(" /bin/true\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${url_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("}")]),s._v('"')]),s._v(" /bin/false\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("check_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        check_url\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v("[32m------- check count: "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${check_count}")]),s._v("-------"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v('[0m"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nmain\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br")])]),t("h2",{attrs:{id:"_003-正则表达式（样例）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_003-正则表达式（样例）"}},[s._v("#")]),s._v(" 003 正则表达式（样例）")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## sed正则表达式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/:\\+\\s\\+/:/'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ /_/g'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^$/d'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/[(%)]//g'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^1/d'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/[(*)]//g'")]),s._v(" /tmp/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${RAND}")]),s._v(".sql_out.temp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /tmp/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${RAND}")]),s._v(".sql_out.temp.1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 后面还有一行：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -ni "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'H;"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${x;s"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("g;p}")]),s._v("'")]),s._v(" /tmp/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${RAND}")]),s._v(".sql_out.temp.1 \n\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/:\\+\\s\\+/:/'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ /_/g'")]),s._v(" 把每一行 第一次出现的 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"连续 n 个 : 及 后面的m个空格"')]),s._v(" 替换成 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" , 再把这一行中剩余的类似匹配内容替换成 _ , 其中 n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n比如如果某行的内容是sss:: ppp: MMM则替换后变成sss:ppp_MMM\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 然后")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^$/d'")]),s._v("删除空行\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 然后")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/[(%)]//g'")]),s._v(" 把每行出现的 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" 或者 % 或者 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 字符全部删除,\n比如abc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("% 被替换成 abc\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 然后")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^1/d'")]),s._v(" 将 以字符 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 开头的行删除\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 最后")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/[(*)]//'")]),s._v("把每行第一次出现的 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" 或者 * 或者 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 字符删除.\n\n注意,上面的每一个 -e 命令处理的对象都是前一条 -e 命令处理完后的结果.\n所以假定有一个文件内容为\nabc "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unchanged line")]),s._v("\nsss:: ppp: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("M%MM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("zzz :::: end "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# change to sss:ppp_MMMzzz_end")]),s._v("\n1me "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#this line will be deleted")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("* "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#change to 2123")]),s._v("\nend of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unchanged")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 经过上面的命令后,变成")]),s._v("\nabc "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unchanged line")]),s._v("\nsss:ppp_M%MMzzz _end "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# change to sss:ppp_MMMzzz _end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2123")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#change to 2123")]),s._v("\nend of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unchanged")]),s._v("\n\n\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Now_Time")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date +%Y%m%d%H%M%S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NowStamp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date +%s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"当前时间和当前时间戳"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Now_Time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NowStamp")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#grep")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -E "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'([0-9]{1,}\\.){3,}([0-9]{1,})'")]),s._v(" version*.txt  --color\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sed")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/\\(\\([0-9]\\{1,\\}\\.\\)\\{3,\\}\\)\\([0-9]\\{1,\\}\\)/'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\1"}},[s._v("\\1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Now_Time}")]),s._v('/g"')]),s._v(" version*.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("h2",{attrs:{id:"_004-sh-echo-colorful-sh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_004-sh-echo-colorful-sh"}},[s._v("#")]),s._v(" 004 sh_echo_colorful.sh")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("echo_r")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$#")]),s._v(" -ne "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v("[31m"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v('[0m"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("echo_g")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$#")]),s._v(" -ne "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v("[32m"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v('[0m"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("echo_y")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$#")]),s._v(" -ne "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v("[33m"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v('[0m"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("echo_b")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$#")]),s._v(" -ne "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v("[34m"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[s._v("\\033")]),s._v('[0m"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PS1")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\['),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("tput bold"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("tput setab "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("tput setaf "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\\][\\u@\\h \\W]# \\["),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("tput sgr0"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('\\]"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PS1")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[37;1m\\][\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[31;1m\\]\\u\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[34;1m\\]@\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[32;1m\\]\\h \\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[31;1m\\]\\w \\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[33;1m\\]"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[s._v("\\t")]),s._v("\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[37;1m\\]]\\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[32;1m\\]\\$ \\["),t("span",{pre:!0,attrs:{class:"token entity",title:"\\e"}},[s._v("\\e")]),s._v("[m\\]'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h3",{attrs:{id:"_004-shell-log"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_004-shell-log"}},[s._v("#")]),s._v(" 004 shell log")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sys_log")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./test_log.log"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# func of log")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#定义了三个级别的日志")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("log_info")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("format_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d_%H%M%S"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("para")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${format_date}")]),s._v(" [info] "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys_log")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("log_warn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("format_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d_%H%M%S"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("para")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${format_date}")]),s._v(" [warn] "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys_log")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("log_err")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("format_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d_%H%M%S"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("para")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${format_date}")]),s._v(" [err] "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys_log")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#log_err "wo shi err"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#log_info "wo shi info info"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#log_warn "wo shi warn"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("h2",{attrs:{id:"_005-wireshark和fiddler抓包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_005-wireshark和fiddler抓包"}},[s._v("#")]),s._v(" 005 wireshark和Fiddler抓包")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("Fiddler是在windows上运行的程序，专门用来捕获HTTP，HTTPS的。\n\nwireshark能获取HTTP，也能获取HTTPS，但是不能解密HTTPS，所以wireshark看不懂HTTPS中的内容\n\n总结，如果是处理HTTP,HTTPS 还是用Fiddler,  其他协议比如TCP,UDP 就用wireshark\nhttps://www.cnblogs.com/TankXiao/archive/2012/10/10/2711777.html\nhttps://www.cnblogs.com/TankXiao/archive/2012/02/06/2337728.html\n\nhttps://my.oschina.net/u/658658/blog/417739\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Wireshark抓包分析——TCP/IP协议https://zhuanlan.zhihu.com/p/53338327")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Fiddler抓取Android真机上的HTTPS包https://www.cnblogs.com/taojietx/p/7286703.html")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Fiddler抓包工具总结https://www.cnblogs.com/yyhh/p/5140852.htmlhttps://www.dell.com/community/%E7%BB%BC%E5%90%88%E8%AE%A8%E8%AE%BA%E5%8C%BA/%E7%BD%91%E7%BB%9C%E5%9F%BA%E6%9C%AC%E5%8A%9F%E7%B3%BB%E5%88%97-%E7%BB%86%E8%AF%B4%E7%BD%91%E7%BB%9C%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF-3%E6%9C%8826%E6%97%A5%E6%9B%B4%E6%96%B0/td-p/7045185")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## wireshark包过滤")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ip.src")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("192.168.1.102 or ip.dst==192.168.1.102")]),s._v("\n\n1 过滤IP，如来源IP或者目标IP等于某个IP\n如前面说的例子： ip.src"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("192.168.1.102 or ip.dst==192.168.1.102")]),s._v("\n比如TCP，只显示TCP协议。\n2 过滤端口\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("tcp.dstport")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" 80 // 只显tcp协议的目标端口80")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("tcp.srcport")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" 80 // 只显tcp协议的来源端口80")]),s._v("\n也可以写成tcp.port eq 80 or udp.port eq 80 这样的模式\n3 过滤协议\n单独写上tcp、udp、xml、http就可以过滤出具体协议的报文。你也可以用tcp or xml这样格式来过滤。\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("我们还可以更加具体过滤协议的内容，如tcp.flags.syn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" 0x02 表示显示包含TCP SYN标志的封包。")]),s._v("\n4 过滤mac地址\neth.src eq A0:00:00:04:C5:84 // 过滤来源mac地址\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("eth.dst")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("A0:00:00:04:C5:84 // 过滤目的mac地址")]),s._v("\n5 http模式过滤\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "GET"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "POST"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.uri")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "/img/logo-edu.gif"')]),s._v('\nhttp contains "GET"\nhttp contains "HTTP/1."\n// GET包\n'),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "GET" && http contains "Host: "')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "GET" && http contains "User-Agent: "')]),s._v("\n// POST包\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "POST" && http contains "Host: "')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("http.request.method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(' "POST" && http contains "User-Agent: "')]),s._v('\n// 响应包\nhttp contains "HTTP/1.1 200 OK" && http contains "Content-Type: "\nhttp contains "HTTP/1.0 200 OK" && http contains "Content-Type: "\n6 过滤内容\ncontains：包含某字符串\n'),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ip.src")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("192.168.1.107 and udp contains 02:12:21:00:22")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ip.src")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('192.168.1.107 and tcp contains "GET"')]),s._v('\n前面也有例子，http contains "HTTP/1.0 200 OK" && http contains "Content-Type: "\n\nhttps://blog.csdn.net/u014530704/article/details/78842000\n\n'),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 抓包")]),s._v("\ntcpdump -i ens33  host gc.hgame.com\n\nhttps://blog.csdn.net/weixin_40576010/article/details/99335491\nhttps://www.cnblogs.com/centos2017/p/7896658.html\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])]),t("h3",{attrs:{id:"_005-抓包mimtproxy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_005-抓包mimtproxy"}},[s._v("#")]),s._v(" 005 抓包mimtproxy")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/ITXiaoAng/p/11777060.html#%E4%B8%89%EF%BC%9A%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7mitmproxy%E5%85%8D%E8%B4%B9%E7%9A%84\n\nhttps://www.cnblogs.com/grandlulu/p/9525417.html\n\nhttps://blog.csdn.net/freeking101/article/details/83901842\n\nhttps://www.jianshu.com/p/0eb46f21fee9\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_005-tcpdump命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_005-tcpdump命令"}},[s._v("#")]),s._v(" 005 tcpdump命令")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("tcpdump -i eth0 -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -l\ntcpdump -i eth0 -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -l -w - "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("strings\n\ntcpdump -i ens33  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" gc.hgame.com\ntcpdump -i eth0 -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -l -w a.pcap src "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.191 or dst "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.191 \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1.3 常用场景")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 1、获取10.1.85.21和10.1.85.19之间的通信，使用命令注意转义符号。")]),s._v("\ntcpdump "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.21 and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.19"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -i ens5f0 -nn -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 2、获取从10.1.85.21发来的包。")]),s._v("\ntcpdump src "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.21 -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -i ens5f1\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 3、监听tcp（udp）端口。")]),s._v("\ntcpdump tcp port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 4、获取主机10.1.85.21和除10.1.85.19之外所有主机的通信。")]),s._v("\ntcpdump "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.21 and "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.19 -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -i any\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 5、获取从10.1.85.19且端口主机到10.1.85.21主机的通信。")]),s._v("\n\ntcpdump src "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.19 and src port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("48565")]),s._v(" and dst "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".85.21 and dst port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5090")]),s._v(" -i any -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -nn\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#################3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 6、抓取所有经过 en0，目的或源地址是 10.37.63.255 的网络数据：")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.255\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 7、抓取主机10.37.63.255和主机10.37.63.61或10.37.63.95的通信：")]),s._v("\ntcpdump "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.255 and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.61 or "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.95 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 8、抓取主机192.168.13.210除了和主机10.37.63.61之外所有主机通信的数据包：")]),s._v("\ntcpdump -n "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.255 and "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.61\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 9、抓取主机10.37.63.255除了和主机10.37.63.61之外所有主机通信的ip包")]),s._v("\ntcpdump "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.255 and "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.61\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 10、抓取主机10.37.63.3发送的所有数据：")]),s._v("\ntcpdump -i en0 src "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.3 （注意数据流向）\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 11、抓取主机10.37.63.3接收的所有数据：")]),s._v("\ntcpdump -i en0 dst "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.3 （注意数据流向） \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 12、抓取主机10.37.63.3所有在TCP 80端口的数据包：")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.3 and tcp port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 13、抓取HTTP主机10.37.63.3在80端口接收到的数据包：")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.37")]),s._v(".63.3 and dst port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 14、抓取所有经过 en0，目的或源端口是 25 的网络数据")]),s._v("\ntcpdump -i en0 port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\ntcpdump -i en0 src port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 源端口")]),s._v("\ntcpdump -i en0 dst port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("网络过滤 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目的端口")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 15、抓取所有经过 en0，网络是 192.168上的数据包")]),s._v("\ntcpdump -i en0 net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v("\ntcpdump -i en0 src net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v("\ntcpdump -i en0 dst net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v("\ntcpdump -i en0 net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1\ntcpdump -i en0 net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.0/24\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 16、协议过滤")]),s._v("\ntcpdump -i en0 arp\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v("\ntcpdump -i en0 tcp\ntcpdump -i en0 udp\ntcpdump -i en0 icmp\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 17、抓取所有经过 en0，目的地址是 192.168.1.254 或 192.168.1.200 端口是 80 的 TCP 数据")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("tcp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("dst host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".254")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dst host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v(")'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 18、抓取所有经过 en0，目标 MAC 地址是 00:01:02:03:04:05 的 ICMP 数据")]),s._v("\ntcpdump -i eth1 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("icmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("ether dst host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("05")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v(")'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 19、抓取所有经过 en0，目的网络是 192.168，但目的主机不是 192.168.1.200 的 TCP 数据")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("tcp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("dst net "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("not dst host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v(")'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 20、只抓 SYN 包")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp[tcpflags] = tcp-syn'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 21、抓 SYN, ACK")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp[tcpflags] & tcp-syn != 0 and tcp[tcpflags] & tcp-ack != 0'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('### 22、抓 SMTP 数据，抓取数据区开始为"MAIL"的包，"MAIL"的十六进制为 0x4d41494c')]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tcp["),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tcp["),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("]"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("] "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x4d41494c")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('### 23、抓 HTTP GET 数据，"GET "的十六进制是 0x47455420')]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp[(tcp[12]>>2):4] = 0x47455420'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 0x4745 为"GET"前两个字母"GE",0x4854 为"HTTP"前两个字母"HT"')]),s._v("\ntcpdump  -XvvennSs "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -i en0 tcp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x4745 or tcp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x4854\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('### 24、抓 SSH 返回，"SSH-"的十六进制是 0x5353482D')]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp[(tcp[12]>>2):4] = 0x5353482D'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 抓老版本的 SSH 返回信息，如"SSH-1.99.."')]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(tcp[(tcp[12]>>2):4] = 0x5353482D) and (tcp[((tcp[12]>>2)+4):2] = 0x312E)'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 25、抓 DNS 请求数据")]),s._v("\ntcpdump -i en0 udp dst port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 26、用-c 参数指定抓多少个包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" tcpdump -nn -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp[tcpflags] = tcp-syn'")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n\n上面的命令计算抓 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" 个 SYN 包花费多少时间，可以判断访问量大概是多少。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 27、实时抓取端口号8000的GET包，然后写入GET.log")]),s._v("\ntcpdump -i en0 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tcp["),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tcp["),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("]"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("]"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x47455420")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("'")]),s._v(" -nnAl -w /tmp/GET.log\n\n作者：道无虚\n链接：https://www.jianshu.com/p/23427a80fc9d\n\n作者：猿码架构\n链接：https://www.jianshu.com/p/a62ed1bb5b20\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br")])]),t("h2",{attrs:{id:"_006"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_006"}},[s._v("#")]),s._v(" 006")]),s._v(" "),t("h2",{attrs:{id:"_007-压测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_007-压测"}},[s._v("#")]),s._v(" 007 压测")]),s._v(" "),t("h3",{attrs:{id:"_007-redis压测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_007-redis压测"}},[s._v("#")]),s._v(" 007 redis压测")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## redis压测")]),s._v("\nredis-cli --latency -h "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\nredis-cli --latency -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.210 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7379")]),s._v("\n\nINFO commandstats \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_007-nginx压测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_007-nginx压测"}},[s._v("#")]),s._v(" 007 nginx压测")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("bin/wrk -c30 -t1 -s conf/nginx_log.lua http://localhost:8095\n\nab -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" http://www.load_balance.com/buy/ticket\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 配置负载均衡")]),s._v("\nupstream load_rule "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:3001 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n       server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:3002 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n       server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:3003 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n       server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:3004 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nserver "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name  load_balance.com www.load_balance.com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    location / "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       proxy_pass http://load_rule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n统计日志中的结果，3001-3004 端口分别得到了 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("、200、300、400 的请求量。这和我在 Nginx 中配置的权重占比很好的吻合在了一起，并且负载后的流量非常的均匀、随机。\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h2",{attrs:{id:"_008-虚拟内存使用排行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_008-虚拟内存使用排行"}},[s._v("#")]),s._v(" 008 虚拟内存使用排行")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /proc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^[0-9]"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" >100'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/Swap:/{a=a+"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}END{print '")]),s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$i")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\',a/1024"')]),s._v("M"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"}' /proc/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$i")]),s._v("/smaps ;done |sort -k2nr|head\n\nfor file in /proc/*/status ; do awk '/VmSwap|Name|^Pid/{printf "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(' "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$3")]),s._v('}END{ print "')]),s._v('"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("' "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -k "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -n -r "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -m\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /proc/sys/vm/drop_caches\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -m\n\nswapoff -a\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -m\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("swapon")]),s._v(" -a\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -m\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h2",{attrs:{id:"_009-linux端口预留"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_009-linux端口预留"}},[s._v("#")]),s._v(" 009 Linux端口预留")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 预留端口避免占用ip_local_reserved_ports")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bl_ports")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("egrep")]),s._v(" -o "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'=[0-9]{4,5}$'")]),s._v("  /opt/www/*/*gs*/*server.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ /,/g'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\nsysctl -w net.ipv4.ip_local_reserved_ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$bl_ports")]),s._v("\n\n\nsysctl -w net.ipv4.ip_local_reserved_ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11181,11281")]),s._v(",12182\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"39003"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /proc/sys/net/ipv4/ip_local_reserved_ports\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"39003,39004"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  /proc/sys/net/ipv4/ip_local_reserved_ports\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"39003-39004"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /proc/sys/net/ipv4/ip_local_reserved_ports\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"_010-清空memcache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_010-清空memcache"}},[s._v("#")]),s._v(" 010 清空memcache")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 清空memcache")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### https://blog.csdn.net/hadeys/article/details/6217472")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flush_all"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11211")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_011-redis-数据持久化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_011-redis-数据持久化"}},[s._v("#")]),s._v(" 011 redis 数据持久化")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Redis 五大数据类型有：")]),s._v("\nString 类型，Hash 类型，List 类型，Set 类型，Zset（Sortedset）类型。其中常用的是前三个\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 数据安全 aof, rdb")]),s._v("\nhttps://www.cnblogs.com/itdragon/p/7906481.html\nRedis 默认开启RDB持久化方式，在指定的时间间隔内，执行指定次数的写操作，则将内存中的数据写入到磁盘中。\nRDB 持久化适合大规模的数据恢复但它的数据一致性和完整性较差。\nRedis 需要手动开启AOF持久化方式，默认是每秒将写操作日志追加到AOF文件中。\nAOF 的数据完整性比RDB高，但记录内容多了，会影响数据恢复的效率。\nRedis 针对 AOF文件大的问题，提供重写的瘦身机制。\n若只打算用Redis 做缓存，可以关闭持久化。\n若打算使用Redis 的持久化。建议RDB和AOF都开启。其实RDB更适合做数据的备份，留一后手。AOF出问题了，还有RDB\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 内存淘汰策略")]),s._v("\n实际上Redis定义了几种策略用来处理这种情况：\nnoeviction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("默认策略"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外）\nallkeys-lru：从所有key中使用LRU算法进行淘汰\nvolatile-lru：从设置了过期时间的key中使用LRU算法进行淘汰\nallkeys-random：从所有key中随机淘汰数据\nvolatile-random：从设置了过期时间的key中随机淘汰\nvolatile-ttl：在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰\n\n作者：千山qianshan\n链接：https://juejin.im/post/6844903927037558792\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 缓存雪崩， 缓存穿透， 缓存")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h2",{attrs:{id:"_012-python常用pip模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_012-python常用pip模块"}},[s._v("#")]),s._v(" 012 python常用pip模块")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("cat  /root/.pip/pip.conf\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[global]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("index-url")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" http://mirrors.aliyun.com/pypi/simple/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[install]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("trusted-host")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("mirrors.aliyun.com")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 运维")]),s._v("\nos, commands, subprocess, logging, Jinja2, PyMySQL, redis, \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 爬虫")]),s._v("\nrequests, bs4, selenium, pyquery\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 框架")]),s._v("\ndjango, flask, fastapi, \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"_012-pip使用指定源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_012-pip使用指定源"}},[s._v("#")]),s._v(" 012 pip使用指定源")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("pip install flask\n\npip install -i http://pypi.douban.com/simple/ --trusted-host"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("pypi.douban.com/simple ipython")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## linux 添加pip源")]),s._v("\ncat  ~/.pip/pip.conf\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[global]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("index-url")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" http://mirrors.aliyun.com/pypi/simple/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[install]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("trusted-host")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("mirrors.aliyun.com")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"_013-npm-or-yarn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_013-npm-or-yarn"}},[s._v("#")]),s._v(" 013 npm or yarn")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("https://www.cnblogs.com/xifengxiaoma/tag/vue/\n\nhttps://www.cnblogs.com/xifengxiaoma/p/9533018.html\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --dev\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --global "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" global "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" uninstall --save "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" remove "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" uninstall --save-dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" remove "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" sass-loader node-sass --dev\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("style "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lang")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scss"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/style"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" mockjs --dev\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h2",{attrs:{id:"_014-查看zip包里面的文件和大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_014-查看zip包里面的文件和大小"}},[s._v("#")]),s._v(" 014 查看zip包里面的文件和大小")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env python")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" zipfile\nz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" zipfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ZipFile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.zip"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"r"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" filename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" z"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("namelist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'File:'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("filename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" z"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'has'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bytes'")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"_015-日志切割logrotate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_015-日志切割logrotate"}},[s._v("#")]),s._v(" 015 日志切割logrotate")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("rpm -qf  /etc/logrotate.conf\nlogrotate-3.7.8-26.el6_7.x86_64\n\n/opt/log/nginx/*.log\n{\n    daily\n    missingok\n    rotate 1\n    compress\n    notifempty\n    copytruncate\n    dateext\n    dateformat %Y-%m-%d\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"_016-xxx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_016-xxx"}},[s._v("#")]),s._v(" 016 xxx")]),s._v(" "),t("h2",{attrs:{id:"_017-xxx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_017-xxx"}},[s._v("#")]),s._v(" 017 xxx")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_018-xxx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_018-xxx"}},[s._v("#")]),s._v(" 018 xxx")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_019-获取git-commit-id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_019-获取git-commit-id"}},[s._v("#")]),s._v(" 019 获取git commit id")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("https://blog.csdn.net/liurizhou/article/details/89234032\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s"')]),s._v("  -2\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%H"')]),s._v("  -2\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log  --pretty"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%h"')]),s._v("  -2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"_020-访问url-分阶段展示耗时"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_020-访问url-分阶段展示耗时"}},[s._v("#")]),s._v(" 020 访问url 分阶段展示耗时")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://github.com/reorx/httpstat ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以前遇到了一台服务器请求某个api很慢，怀疑是dns但是没有证据，这下让他无处遁形")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://raw.githubusercontent.com/reorx/httpstat/master/httpstat.py")]),s._v("\npip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" httpstat\npython httpstat.py httpbin.org/get\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"_021-mysql-binlog2sql-解析binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_021-mysql-binlog2sql-解析binlog"}},[s._v("#")]),s._v(" 021 MySQL binlog2sql 解析binlog")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://github.com/danfengcao/binlog2sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ")]),s._v("\nhttps://github.com/danfengcao/binlog2sql/blob/master/example/mysql-flashback-priciple-and-practice.md\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## records")]),s._v("\nhttps://github.com/kennethreitz-archive/records\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"_022-innodb-和myisam-不同点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_022-innodb-和myisam-不同点"}},[s._v("#")]),s._v(" 022 InnoDB 和MyISAM 不同点")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("MyISAM与InnoDB 的区别（9个不同点）\n\n1. InnoDB支持事务，MyISAM不支持，对于InnoDB每一条SQL语言都默认封装成事务，自动提交，这样会影响速度，所以最好把多条SQL语言放在begin和commit之间，组成一个事务； \n\n2. InnoDB支持外键，而MyISAM不支持。对一个包含外键的InnoDB表转为MYISAM会失败\n5. Innodb不支持全文索引，而MyISAM支持全文索引，在涉及全文索引领域的查询效率上MyISAM速度更快高；PS：5.7以后的InnoDB支持全文索引了\n\n6. MyISAM表格可以被压缩后进行查询操作\n7. InnoDB支持表、行(默认)级锁，而MyISAM支持表级锁\n8、InnoDB表必须有主键（用户没有指定的话会自己找或生产一个主键），而Myisam可以没有\n9、Innodb存储文件有frm、ibd，而Myisam是frm、MYD、MYI\n        Innodb：frm是表定义文件，ibd是数据文件\n        Myisam：frm是表定义文件，myd是数据文件，myi是索引文件\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"_023-mysql忘记密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_023-mysql忘记密码"}},[s._v("#")]),s._v(" 023 MySQL忘记密码")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("vim /etc/my.cnf\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[mysqld]")]),s._v("\nskip-grant-tables\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### MySQL5.6")]),s._v("\nUPDATE mysql.user SET Password "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" password('123456') WHERE User = 'root' ; ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### MySQL5.7")]),s._v("\nupdate mysql.user set authentication_string"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("password('123qwe') where user='root' and Host = 'localhost';")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"_024-mysql审计-yearning"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_024-mysql审计-yearning"}},[s._v("#")]),s._v(" 024  MySQL审计 yearning")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://www.jianshu.com/p/c9c3aaaf6e0b")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_025-waiting-for-table-flush-阻塞查询的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_025-waiting-for-table-flush-阻塞查询的问题"}},[s._v("#")]),s._v(" 025 Waiting for table flush 阻塞查询的问题")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://blog.csdn.net/donghaixiaolongwang/article/details/76099697")]),s._v("\n2、易引发这种情况的操作\n慢查询+FLUSH TABLES tbl_name, ALTER TABLE, RENAME TABLE, REPAIR TABLE, ANALYZE TABLE, orOPTIMIZE TABLE  这些操作。\n\n例如：比如在mysqldump、innobackupex进行备份时就很有可能引发这种情况。\n\n3、解决方案\n找出慢查询kill掉，并进行SQL优化防止再次引发。\n\n4、预防措施\n在业务高峰期不要对数据库进行FLUSH TABLES tbl_name, ALTER TABLE, RENAME TABLE, REPAIR TABLE, ANALYZE TABLE, orOPTIMIZE TABLE 这些操作。\n\n备份、DDL语句等操作尽量避开业务高峰。\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### ")]),s._v("\nSELECT CONCAT('kill  ',id,';') from PROCESSLIST WHERE state "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('\'updating\' and (info like "%xxxx_server_info%" and info like "update%") limit 50')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_026-mysql时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_026-mysql时间"}},[s._v("#")]),s._v(" 026 mysql时间")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1、当前日期")]),s._v("\nselect DATE_SUB(curdate(),INTERVAL 0 DAY) ;\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2、明天日期")]),s._v("\nselect DATE_SUB(curdate(),INTERVAL -1 DAY) ;\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3、昨天日期")]),s._v("\nselect DATE_SUB(curdate(),INTERVAL 1 DAY) ;\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 4、前一个小时时间")]),s._v("\nselect date_sub(now(), interval 1 hour);\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 5、后一个小时时间")]),s._v("\nselect date_sub(now(), interval -1 hour);\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 6、前30分钟时间")]),s._v("\nselect date_add(now(),interval -30 minute)\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 7、后30分钟时间")]),s._v("\nselect date_add(now(),interval 30 minute)\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 8、取得当天：")]),s._v("\nSELECT curdate();\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"_027"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_027"}},[s._v("#")]),s._v(" 027")]),s._v(" "),t("h2",{attrs:{id:"_028"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_028"}},[s._v("#")]),s._v(" 028")]),s._v(" "),t("h2",{attrs:{id:"_029"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_029"}},[s._v("#")]),s._v(" 029")]),s._v(" "),t("h2",{attrs:{id:"_030"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_030"}},[s._v("#")]),s._v(" 030")]),s._v(" "),t("h2",{attrs:{id:"_031"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_031"}},[s._v("#")]),s._v(" 031")]),s._v(" "),t("h2",{attrs:{id:"_032"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_032"}},[s._v("#")]),s._v(" 032")]),s._v(" "),t("h2",{attrs:{id:"_033"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_033"}},[s._v("#")]),s._v(" 033")]),s._v(" "),t("h2",{attrs:{id:"_034"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_034"}},[s._v("#")]),s._v(" 034")]),s._v(" "),t("h2",{attrs:{id:"_035"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_035"}},[s._v("#")]),s._v(" 035")]),s._v(" "),t("h2",{attrs:{id:"_036"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_036"}},[s._v("#")]),s._v(" 036")]),s._v(" "),t("h2",{attrs:{id:"_037"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_037"}},[s._v("#")]),s._v(" 037")]),s._v(" "),t("h2",{attrs:{id:"_038"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_038"}},[s._v("#")]),s._v(" 038")]),s._v(" "),t("h2",{attrs:{id:"_039"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_039"}},[s._v("#")]),s._v(" 039")]),s._v(" "),t("h2",{attrs:{id:"_040"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_040"}},[s._v("#")]),s._v(" 040")]),s._v(" "),t("h2",{attrs:{id:"_041"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_041"}},[s._v("#")]),s._v(" 041")]),s._v(" "),t("h2",{attrs:{id:"_042"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_042"}},[s._v("#")]),s._v(" 042")]),s._v(" "),t("h2",{attrs:{id:"_043"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_043"}},[s._v("#")]),s._v(" 043")]),s._v(" "),t("h2",{attrs:{id:"_044"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_044"}},[s._v("#")]),s._v(" 044")]),s._v(" "),t("h2",{attrs:{id:"_045"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_045"}},[s._v("#")]),s._v(" 045")]),s._v(" "),t("h2",{attrs:{id:"_046"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_046"}},[s._v("#")]),s._v(" 046")]),s._v(" "),t("h2",{attrs:{id:"_047"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_047"}},[s._v("#")]),s._v(" 047")]),s._v(" "),t("h2",{attrs:{id:"_048"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_048"}},[s._v("#")]),s._v(" 048")]),s._v(" "),t("h2",{attrs:{id:"_049"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_049"}},[s._v("#")]),s._v(" 049")]),s._v(" "),t("h2",{attrs:{id:"_050-前端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_050-前端"}},[s._v("#")]),s._v(" 050 前端")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bootstrap")]),s._v("\nhttps://www.runoob.com/bootstrap/bootstrap-affix-plugin.html\nhttps://www.w3cschool.cn/bootstrap/html-css-bootstrap-radiobutton.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## jQuery 加载 json 数据")]),s._v("\nhttps://www.cnblogs.com/aademeng/articles/9788385.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## jQuery 添加元素")]),s._v("\nhttps://www.runoob.com/jquery/jquery-dom-set.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ant-design")]),s._v("\nhttps://www.yuque.com/ant-design/course/wybhm9\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## gin")]),s._v("\nhttps://book.eddycjy.com/golang/gin/log.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## vue")]),s._v("\nhttps://github.com/opendigg/awesome-github-vue\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h2",{attrs:{id:"_051-vue动态菜单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_051-vue动态菜单"}},[s._v("#")]),s._v(" 051 vue动态菜单")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("## https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnblogs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("woai3c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11052975.")]),s._v("html\n\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" 动态菜单 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("div v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(item, index) in menuItems"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Submenu v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.children"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("template slot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Icon "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.size"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("span v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("item"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("span"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("template"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("div v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(subItem, i) in item.children"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index + i"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Submenu v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.children"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"index + '-' + i\"")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("template slot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Icon "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.size"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("span v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("subItem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("span"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("template"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("MenuItem "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"menu-level-3"')]),s._v(" v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(threeItem, k) in subItem.children"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"threeItem.name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index + i + k"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Icon "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"threeItem.size"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"threeItem.type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("span v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("threeItem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("span"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("MenuItem"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Submenu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("MenuItem v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Icon "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.size"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subItem.type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("span v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("subItem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("span"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("MenuItem"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("div"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Submenu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("MenuItem v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Icon "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.size"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"item.type"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("span v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("show"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isShowAsideTitle"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("item"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("span"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("MenuItem"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("div"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h2",{attrs:{id:"_052"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_052"}},[s._v("#")]),s._v(" 052")]),s._v(" "),t("h2",{attrs:{id:"_053"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_053"}},[s._v("#")]),s._v(" 053")]),s._v(" "),t("h2",{attrs:{id:"_054"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_054"}},[s._v("#")]),s._v(" 054")]),s._v(" "),t("h2",{attrs:{id:"_055"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_055"}},[s._v("#")]),s._v(" 055")]),s._v(" "),t("h2",{attrs:{id:"_056"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_056"}},[s._v("#")]),s._v(" 056")]),s._v(" "),t("h2",{attrs:{id:"_057"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_057"}},[s._v("#")]),s._v(" 057")]),s._v(" "),t("h2",{attrs:{id:"_058"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_058"}},[s._v("#")]),s._v(" 058")]),s._v(" "),t("h2",{attrs:{id:"_059"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_059"}},[s._v("#")]),s._v(" 059")]),s._v(" "),t("h2",{attrs:{id:"_060-python-第三方包制作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_060-python-第三方包制作"}},[s._v("#")]),s._v(" 060 python 第三方包制作")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Python 第三方包制作教程")]),s._v("\nhttps://www.cnblogs.com/streakingBird/p/4056765.html\n\nhttps://www.jianshu.com/p/19f1e564a29d\nhttps://www.cnblogs.com/panwenbin-logs/p/13219332.html\nhttps://www.jianshu.com/p/c6055e8873ee\n\nDjango 中使用 ajax 请求的正确姿势\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## git 0基础入门—git入门与实践（1）—详细图解git安装详情及超详细的入门介绍！（2020.06.30更新）")]),s._v('\nhttps://blog.csdn.net/u013946061/article/details/107023191\ngit config --globe user.email “xxx@example.com”\n--globe 代表全局设置，即设置一次就够了。\ngit config --globe user.name "张三"\n\ngit config --global -l\n\ngit commit -a -m "描述" 从工作目录提交到暂存区后，直接提交\n\n'),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## golang prometheus")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### Go开发属于自己的exporter")]),s._v("\nhttps://blog.csdn.net/weixin_45413603/article/details/107024467\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 使用golang编写Prometheus Exporter")]),s._v("\nhttps://blog.csdn.net/u014029783/article/details/80001251\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### prometheus数据采集exporter全家桶")]),s._v("\nhttps://blog.csdn.net/weixin_34212189/article/details/91673377\n\n名称.(type)用于类型查询,\n名称.(具体类型)用于类型转换\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Google Protobuf简明教程")]),s._v("\nhttps://www.jianshu.com/p/b723053a86a6\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## python 操作protobuf")]),s._v("\nhttps://www.jianshu.com/p/091b99beb6bc\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("h2",{attrs:{id:"_061-python-is-和-区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python-is-和-区别"}},[s._v("#")]),s._v(" 061 python 'is' 和 '==' 区别")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("https://www.cnblogs.com/CheeseZH/p/5260560.html\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("在讲is和")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("这两种运算符区别之前，首先要知道Python中对象包含的三个基本要素，分别是：id(身份标识)、type(数据类型)和value(值)。")]),s._v("\n1, is 是进行id的比较，"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" 是进行value的比较。")]),s._v("\n2, 只有数值型情况下is和"),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("可通用，当字符串中包含非数字或字母字符时，值比较就不能用is只能用==了。")]),s._v("\n\n我们在检查 a is b 的时候，其实相当于检查 id(a) "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" id(b)。而检查 a == b 的时候，实际是调用了对象 a 的 __eq()__ 方法，a == b 相当于 a.__eq__(b)。")]),s._v("\n\nPython里和None比较时，为什么是 is None 而不是 "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" None 呢？")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("这是因为None在Python里是个单例对象，一个变量如果是None，它一定和None指向同一个内存地址。而")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" None背后调用的是__eq__，而__eq__可以被重载，下面是一个 is not None但 == None的例子")]),s._v("\n\n连接字符串的时候可以用join也可以用+，但这两者有没有区别呢？\njoin的性能明显好于+。这是为什么呢？\n而join在连接字符串的时候，会先计算需要多大的内存存放结果，然后一次性申请所需内存并将字符串复制过去，这是为什么join的性能优于+的原因。所以在连接字符串数组的时候，我们应考虑优先使用join。\n\nhttps://zhuanlan.zhihu.com/p/93775624\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h4",{attrs:{id:"_061-python-深浅拷贝"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python-深浅拷贝"}},[s._v("#")]),s._v(" 061 python 深浅拷贝")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("浅拷贝和深拷贝的区别是：浅拷贝只是将原对象在内存中引用地址拷贝\n\n而深拷贝是将这个对象的所有内容拷贝过来了，包括值与内存地址\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_061-python闭包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python闭包"}},[s._v("#")]),s._v(" 061 python闭包")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://c.biancheng.net/view/5335.html")]),s._v("\n不过使用闭包，可以让程序变得更简洁易读。\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://zhuanlan.zhihu.com/p/22229197")]),s._v("\n闭包：就是在一个外函数中定义了一个内函数，内函数里运用了外函数的临时变量，并且 外函数的返回值是内函数的引用。\n闭包概念：在一个内部函数中，对外部作用域的变量进行引用，"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("并且一般外部函数的返回值为内部函数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("，那么内部函数就被认为是闭包。\nflist "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("xrange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("i\n    first"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("func"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" f "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" flist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2")]),s._v("\nflist"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("xrange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("makefunc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("i\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" func\n    flist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("makefunc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" f "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" flist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    \n装饰器"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("本质就是闭包"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：主要作用为已经存在的对象添加额外的功能，例如日志记录、数据校验等。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h4",{attrs:{id:"_061-python-生成器和迭代器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python-生成器和迭代器"}},[s._v("#")]),s._v(" 061 python 生成器和迭代器")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 列表推导式")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## django 字典推导式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("kwargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('{key: request.POST.get(key) for key in ("motto","region","pic") if request.POST.get(key)}')]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"_061-python-魔法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python-魔法"}},[s._v("#")]),s._v(" 061 python 魔法")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v('__init__我们很熟悉了,它在对象初始化的时候调用,我们一般将它理解为"构造函数".\n\n__new__\n\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_061-python-封装、继承和多态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_061-python-封装、继承和多态"}},[s._v("#")]),s._v(" 061 python 封装、继承和多态")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("dd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_062-python-模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_062-python-模块"}},[s._v("#")]),s._v(" 062 python 模块")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_062-python多线-进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_062-python多线-进程"}},[s._v("#")]),s._v(" 062 python多线/进程")]),s._v(" "),t("blockquote",[t("p",[s._v("在 Python 3.2 以后，concurrent.futures是内置的模块，我们可以直接使用。 如果你需要在 Python 2.7 中使用 concurrent.futures , 那么请用 pip 进行安装，")]),s._v(" "),t("p",[s._v("pip install futures")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://www.cnblogs.com/huchong/p/7459324.html")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" concurrent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("futures "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" ProcessPoolExecutor\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" os"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("random\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s is running'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("os"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getpid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sleep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'__main__'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    p"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ProcessPoolExecutor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不填则默认为cpu的个数")]),s._v("\n    l"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    start"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        obj"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("submit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#submit()方法返回的是一个future实例，要得到结果需要用obj.result()")]),s._v("\n        l"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        p"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shutdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#类似用from multiprocessing import Pool实现进程池中的close及join一起的作用")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print([obj for obj in l])")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" l"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上面方法也可写成下面的方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start = time.time()")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# with ProcessPoolExecutor() as p:   #类似打开文件,可省去.shutdown()")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#     future_tasks = [p.submit(task, i) for i in range(10)]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print('=' * 30)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print([obj.result() for obj in future_tasks])")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(time.time() - start)")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("h4",{attrs:{id:"_062-re模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_062-re模块"}},[s._v("#")]),s._v(" 062 re模块")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## re")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" re\nb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<p>我是测试文本<br/></p><p>我是测试文本\\n  \\n<br/></p>"')]),s._v("\nc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" re"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sub"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<[^<]+?>'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("replace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\n'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" re"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("findall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("r'p>(.*?)</p'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" re"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"_063-api的调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_063-api的调用"}},[s._v("#")]),s._v(" 063 API的调用")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_063-salt-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_063-salt-api"}},[s._v("#")]),s._v(" 063 salt-api")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_063-es-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_063-es-api"}},[s._v("#")]),s._v(" 063 es-api")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_063-zabbix-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_063-zabbix-api"}},[s._v("#")]),s._v(" 063 zabbix-api")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_064-shutil压缩处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_064-shutil压缩处理"}},[s._v("#")]),s._v(" 064 shutil压缩处理")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#zipfile 压缩解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://www.cnblogs.com/xiangsikai/p/7787101.html")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" zipfile\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 压缩")]),s._v("\nz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" zipfile.ZipFile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'laxi.zip'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'w'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nz.write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a.log'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nz.write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data.data'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nz.close"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\nz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" zipfile.ZipFile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'laxi.zip'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'r'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nz.extractall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nz.close"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h2",{attrs:{id:"_065"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_065"}},[s._v("#")]),s._v(" 065")]),s._v(" "),t("h2",{attrs:{id:"_066"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_066"}},[s._v("#")]),s._v(" 066")]),s._v(" "),t("h2",{attrs:{id:"_067"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_067"}},[s._v("#")]),s._v(" 067")]),s._v(" "),t("h2",{attrs:{id:"_068"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_068"}},[s._v("#")]),s._v(" 068")]),s._v(" "),t("h2",{attrs:{id:"_069"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_069"}},[s._v("#")]),s._v(" 069")]),s._v(" "),t("h2",{attrs:{id:"_070-golang"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_070-golang"}},[s._v("#")]),s._v(" 070 golang")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## aliyun tools")]),s._v("\nhttps://help.aliyun.com/learn/tool.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Go类型专题总结")]),s._v("\nhttps://blog.csdn.net/YongYu_IT/article/details/90711434\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Go的&*")]),s._v("\nhttps://blog.csdn.net/fujian9544/article/details/100110011\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Golang 中的指针 - Pointer")]),s._v("\nhttps://blog.csdn.net/weixin_30323961/article/details/96412686\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## [日常] Go语言圣经-Slice切片习题")]),s._v("\nhttps://www.cnblogs.com/taoshihan/p/8797499.html\n\nhttps://www.cnblogs.com/majianguo/p/8186429.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"_071"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_071"}},[s._v("#")]),s._v(" 071")]),s._v(" "),t("h2",{attrs:{id:"_072"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_072"}},[s._v("#")]),s._v(" 072")]),s._v(" "),t("h2",{attrs:{id:"_073"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_073"}},[s._v("#")]),s._v(" 073")]),s._v(" "),t("h2",{attrs:{id:"_074"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_074"}},[s._v("#")]),s._v(" 074")]),s._v(" "),t("h2",{attrs:{id:"_075"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_075"}},[s._v("#")]),s._v(" 075")]),s._v(" "),t("h2",{attrs:{id:"_076"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_076"}},[s._v("#")]),s._v(" 076")]),s._v(" "),t("h2",{attrs:{id:"_077"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_077"}},[s._v("#")]),s._v(" 077")]),s._v(" "),t("h2",{attrs:{id:"_078"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_078"}},[s._v("#")]),s._v(" 078")]),s._v(" "),t("h2",{attrs:{id:"_079"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_079"}},[s._v("#")]),s._v(" 079")]),s._v(" "),t("h2",{attrs:{id:"_080-jvm内存优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_080-jvm内存优化"}},[s._v("#")]),s._v(" 080  jvm内存优化")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("\n堆(Heap)和非堆(Non-heap)内存\n    按照官方的说法：“Java 虚拟机具有一个堆，堆是运行时数据区域，所有类实例和数组的内存均从此处分配。堆是在 Java 虚拟机启动时创建的。”“在JVM中堆之外的内存称为非堆内存(Non-heap memory)”。可以看出JVM主要管理两种类型的内存：堆和非堆。简单来说堆就是Java代码可及的内存，是留给开发人员使用的；非堆就是JVM留给 自己用的，所以方法区、JVM内部处理或优化所需的内存(如JIT编译后的代码缓存)、每个类结构(如运行时常数池、字段和方法数据)以及方法和构造方法 的代码都在非堆内存中。\n堆内存分配\n    JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指 定，默认是物理内存的1/4。默认空余堆内存小于40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到 -Xms的最小限制。因此服务器一般设置-Xms、-Xmx相等以避免在每次GC 后调整堆的大小。\n非堆内存分配\n    JVM使用-XX:PermSize设置非堆内存初始值，默认是物理内存的1/64；由XX:MaxPermSize设置最大非堆内存的大小，默认是物理内存的1/4。\nJVM内存限制(最大值)\n    首先JVM内存限制于实际的最大物理内存(废话！呵呵)，假设物理内存无限大的话，JVM内存的最大值跟操作系统有很大的关系。简单的说就32位处理器虽然 可控内存空间有4GB,但是具体的操作系统会给一个限制，这个限制一般是2GB-3GB（一般来说Windows系统下为1.5G-2G，Linux系统 下为2G-3G），而64bit以上的处理器就不会有限制了。\n    \nhttps://blog.csdn.net/cutesource/article/details/5907418\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## tomcat优化")]),s._v("\nhttps://www.cnblogs.com/jojoword/p/10835112.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"_081-jar-illegal-key-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_081-jar-illegal-key-size"}},[s._v("#")]),s._v(" 081  jar Illegal key size")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v('报错描述：java.security.InvalidKeyException: Illegal key size\n原因分析：JRE中自带的“local_policy.jar ”和“US_export_policy.jar”是支持128位密钥的加密算法，而当我们要使用256位密钥算法的时候，已经超出它的范围，无法支持\n\n解决方案：1、## https://blog.csdn.net/dling8/article/details/84061948\n          2、升级jdk，比如 java version "1.8.0_74" 升级到 java version "1.8.0_261"\n\n参考链接：https://stackoverflow.com/questions/6481627/java-security-illegal-key-size-or-default-parameters\n\n摘要说明：Make sure you use the latest version of JDK/JRE.\nIn my case, I had put JCE into JRE folder, but it didn\'t help. It happened because I was running my project from the IDE directly (using JDK).\nThen I updated my JDK and JRE to the latest version (1.8.0_211) and the problem had gone.\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"_082"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_082"}},[s._v("#")]),s._v(" 082")]),s._v(" "),t("h2",{attrs:{id:"_083"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_083"}},[s._v("#")]),s._v(" 083")]),s._v(" "),t("h2",{attrs:{id:"_084"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_084"}},[s._v("#")]),s._v(" 084")]),s._v(" "),t("h2",{attrs:{id:"_085"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_085"}},[s._v("#")]),s._v(" 085")]),s._v(" "),t("h2",{attrs:{id:"_086"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_086"}},[s._v("#")]),s._v(" 086")]),s._v(" "),t("h2",{attrs:{id:"_087"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_087"}},[s._v("#")]),s._v(" 087")]),s._v(" "),t("h2",{attrs:{id:"_088"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_088"}},[s._v("#")]),s._v(" 088")]),s._v(" "),t("h2",{attrs:{id:"_089"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_089"}},[s._v("#")]),s._v(" 089")]),s._v(" "),t("h2",{attrs:{id:"_090-阿里云-k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_090-阿里云-k8s"}},[s._v("#")]),s._v(" 090 阿里云 k8s")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("阿里云 k8s\n\nACK 容器服务Kubernetes版\nASK \n\nACR 容器镜像服务（Alibaba Cloud Container Registry）\n\nECI 弹性容器实例ECI\n\n\n高可用\n\n自动扩容 缩容\nhttps://help.aliyun.com/learn/tool.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"_091"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_091"}},[s._v("#")]),s._v(" 091")]),s._v(" "),t("h2",{attrs:{id:"_092"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_092"}},[s._v("#")]),s._v(" 092")]),s._v(" "),t("h2",{attrs:{id:"_093"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_093"}},[s._v("#")]),s._v(" 093")]),s._v(" "),t("h2",{attrs:{id:"_094"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_094"}},[s._v("#")]),s._v(" 094")]),s._v(" "),t("h2",{attrs:{id:"_095"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_095"}},[s._v("#")]),s._v(" 095")]),s._v(" "),t("h2",{attrs:{id:"_096"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_096"}},[s._v("#")]),s._v(" 096")]),s._v(" "),t("h2",{attrs:{id:"_097-鸡汤几句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_097-鸡汤几句"}},[s._v("#")]),s._v(" 097 鸡汤几句")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("写计划或者一些鼓励自己的话贴在显示器上时时看到，做一条划掉一条，特别有成就感！\n\n所以作为老板，他最希望的事就是自己能帮助到团队里每个员工，能为员工协调资源，能把控风险，掌控大局，最终把事情做好，这样老板自己也能出成绩得到晋升。\n\n如果你能从个人的能力出发，变成了个人的竞争力，再进一步变成了企业的竞争力，这是一件喜闻乐见的事，也是领导想看到的。\n\n你主动展现出愿意承担更多、学习更多的东西的意愿，老板才会把更多的责任交到你的手里面。\n\n所以主动思考，抓住表达红利，你的想法才会得到组织支持和资源支持，相应的你自己也能够实现升职加薪。\n\n凡事有交代，件件有着落，事事有回音\n\n怎么做一个踏实靠谱的人呢？你应该做到凡事有交代, 件件有着落, 事事有回音\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"_097-鸡汤2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_097-鸡汤2"}},[s._v("#")]),s._v(" 097 鸡汤2")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("“我当时没什么自信”，回忆起来那段经历，他这样说。\n既然改变已经发生了，那就尽力做好。没有自信，可以建立自信，没有武功，可以从零学起。\n\n他在“绝情谷底”总结了三条生存法则：\n1，不要多想，直接去做，反正也没有时间想别的；\n2，不敢演讲，那就多练 ，反正客户等着，不讲也不行；\n3，不断提高，那就多学，反正总有建（tiao）议（ti）和反（tu）馈（cao）。\n他为自己设立了一个目标，一周演讲两次，这样一年下来就讲了三四十次。时间长了，突然有一天，他发现自己在人前讲话不紧张了。\n\n那时感觉自己是被逼的，不过现在挺感谢逼我的人，当时在不确定的情况下我只想一件事情，那就是把手头的事情做好。做着做着就发现，原来我真的可以做的很好。\n\n自信就这么来了。这个人叫格茸扎西。\n\n作者：ThoughtWorks中国\n链接：https://www.zhihu.com/question/48406009/answer/155374291\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_098-几个链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_098-几个链接"}},[s._v("#")]),s._v(" 098 几个链接")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## MySQL 三万字精华总结 + 面试100 问")]),s._v("\nhttps://www.jianshu.com/p/24e1179ef563\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 阿里巴巴为什么能抗住90秒100亿？")]),s._v("\nhttps://www.jianshu.com/p/f4a907fe1485\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 终于有人把 Docker 讲清楚了，万字详解！")]),s._v("\nhttps://www.jianshu.com/p/b650b5521d7d\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 当初我要是这么学习Nginx就好了！")]),s._v("\nhttps://www.jianshu.com/p/e90050dc89b6\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 高并发与高可用知识总结")]),s._v("\nhttps://www.cnblogs.com/xuwc/p/9138585.html\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h4",{attrs:{id:"_098-高并发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_098-高并发"}},[s._v("#")]),s._v(" 098 高并发")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("高并发架构相关概念\nhttps://www.cnblogs.com/-mrl/p/13234927.html\n\n高并发解决方案\nhttps://www.cnblogs.com/cn-sbo/p/10853469.html\n\njava高并发解决方案\nhttps://www.cnblogs.com/alex96/p/12152388.html\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"_099-github上有趣的100个python项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_099-github上有趣的100个python项目"}},[s._v("#")]),s._v(" 099 Github上有趣的100个python项目")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Github上有趣的100个python项目")]),s._v("\nhttps://www.jianshu.com/p/d74659727d26\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/kennethreitz-archive/records")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/hangsz/pandas-tutorial")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/xianhu/LearnPython")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/danfengcao/binlog2sql")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/tldr-pages/tldr-python-client")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## https://github.com/Delgan/loguru")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_100-运维技能0-1-设计落地方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-运维技能0-1-设计落地方案"}},[s._v("#")]),s._v(" 100 运维技能0-1 设计落地方案")]),s._v(" "),t("h4",{attrs:{id:"_100-1-linux安全"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-1-linux安全"}},[s._v("#")]),s._v(" 100.1 linux安全")]),s._v(" "),t("h4",{attrs:{id:"_100-2-linux-压测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-2-linux-压测"}},[s._v("#")]),s._v(" 100.2 linux 压测")]),s._v(" "),t("h4",{attrs:{id:"_100-3-nginx-动态负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-3-nginx-动态负载均衡"}},[s._v("#")]),s._v(" 100.3 nginx 动态负载均衡")]),s._v(" "),t("h4",{attrs:{id:"_100-4-k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-4-k8s"}},[s._v("#")]),s._v(" 100.4 k8s")]),s._v(" "),t("h4",{attrs:{id:"_100-5-salt-ssh-实现批量安装salt-minion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-5-salt-ssh-实现批量安装salt-minion"}},[s._v("#")]),s._v(" 100.5 salt-ssh 实现批量安装salt-minion")]),s._v(" "),t("h4",{attrs:{id:"_100-6-巡检模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_100-6-巡检模板"}},[s._v("#")]),s._v(" 100.6 巡检模板")]),s._v(" "),t("h4",{attrs:{id:"yd-mongo迁移到阿里云"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yd-mongo迁移到阿里云"}},[s._v("#")]),s._v(" yd-mongo迁移到阿里云")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 几个概念")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# databases, collection, ducument, index")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# databases, table,  record, index")]),s._v("\nhttps://www.cnblogs.com/clsn/p/8244206.html\nhttps://www.cnblogs.com/shaosks/p/9318209.html\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 备份")]),s._v("\nmongodump -h dbhost -d dbname -o dbdirectory\nmongodump -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:27017 -d smp_maint_2 -o /opt/backup_data/mongo/momgodump\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 恢复")]),s._v("\nmongorestore -h dbhost -d dbname --dir dbdirectory  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# xxx.bson的目录名")]),s._v("\nmongorestore -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:27017 -d smp_maint_2_restore --dir /opt/backup_data/mongo/momgodump/test\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 其他导入导出")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://www.cnblogs.com/clsn/p/8244206.html")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 默认导出了JSON格式的数据")]),s._v("\nmongoexport -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.152:27017 -uroot -proot --authenticationDatabase admin -d app -c vast -o /home/mongod/backup/vasts.dat\n\nmongoexport -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.152:27017 -uroot -proot --authenticationDatabase admin  -d app -c vast --type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("csv -f id,name -o /home/mongod/backup/vast_csv.dat\n\nmongoimport -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.152:27017 -uroot -proot --authenticationDatabase admin  -d app -c vast  --drop /home/mongod/backup/vasts.dat\n\nmongoimport -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.152:27017 -uroot -proot --authenticationDatabase admin -d app -c vast --type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("csv --headerline --file vast_csv.dat\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mongoexport/mongoimport与mongodump/mongorestore的对比")]),s._v("\nmongoexport/mongoimport导入/导出的是JSON格式，而mongodump/mongorestore导入/导出的是BSON格式。\nJSON可读性强但体积较大，BSON则是二进制文件，体积小但对人类几乎没有可读性。\n在一些mongodb版本之间，BSON格式可能会随版本不同而有所不同，所以不同版本之间用mongodump/mongorestore可能不会成功，具体要看版本之间的兼容性。当无法使用BSON进行跨版本的数据迁移的时候，使用JSON格式即mongoexport/mongoimport是一个可选项。跨版本的mongodump/mongorestore并不推荐，实在要做请先检查文档看两个版本是否兼容（大部分时候是的）。\nJSON虽然具有较好的跨版本通用性，但其只保留了数据部分，不保留索引，账户等其他基础信息。使用时应该注意。\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 授权")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 分片")]),s._v("\nhttps://blog.csdn.net/tanga842428/article/details/52584770?locationNum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fps")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br")])]),t("h4",{attrs:{id:"yd-mysql迁移到阿里云"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yd-mysql迁移到阿里云"}},[s._v("#")]),s._v(" yd-MySQL迁移到阿里云")]),s._v(" "),t("h4",{attrs:{id:"yd-传统java应用上阿里k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yd-传统java应用上阿里k8s"}},[s._v("#")]),s._v(" yd-传统java应用上阿里k8s")]),s._v(" "),t("h4",{attrs:{id:"yd-阿里云监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yd-阿里云监控"}},[s._v("#")]),s._v(" yd-阿里云监控")])])}),[],!1,null,null,null);a.default=e.exports}}]);